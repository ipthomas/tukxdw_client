2022/11/23 16:48:38.849811 tukutil.go:140: -----------------------------------------------------------------------------------
2022/11/23 16:48:38.849899 main.go:199: Loaded log file - ./logs/2022/1123.log
2022/11/23 16:48:38.849938 tukdbint.go:235: No Database API URL provided. Opening DB Connection to mysql instance via DSN - root:rootPass@tcp(localhost:3306)/tuk?parseTime=true&timeout=60s&readTimeout=2s
2022/11/23 16:48:38.855031 main.go:193: Loaded pixmpatient.html 
2022/11/23 16:48:38.855070 main.go:171: Persisting HTML Template pixmpatient.html
2022/11/23 16:48:38.855188 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [pixmpatient %!s(bool=false)]
2022/11/23 16:48:38.919929 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [pixmpatient %!s(bool=false) {{define "pixmpatient"}}
{{template "header" .}}
{{template "horizontalline"}}
{{$event := .}}
<div class="container-fluid">
    {{if ne (len .PIXmResponse.Entry) 0}} 
    {{range $entry:= .PIXmResponse.Entry}}
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="familyname">Family</label>
            <p id="familyname" name="familyname">{{range $entry.Resource.Name}}{{.Family}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="givenname">Given</label>
            <p id="givenname" name="givenname">{{range $entry.Resource.Name}}{{.Given}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="nameuse">Use</label>
            <p id="nameuse" name="nameuse">{{range $entry.Resource.Name}}{{.Use}} {{end}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="dob">Birth Date</label>
            <p id="dob" name="dob">{{$entry.Resource.BirthDate}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="gender">Gender</label>
            <p id="pc" name="pc">{{$entry.Resource.Gender}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="pc">PC</label>
            <p id="pc" name="pc">{{range $entry.Resource.Address}}{{.PostalCode}} {{end}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="addr">Address</label>
            <p id="addr" name="addr">{{range $entry.Resource.Address}}{{.Line}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="city">City</label>
            <p id="city" name="city">{{range $entry.Resource.Address}}{{.City}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="addruse">Use</label>
            <p id="addruse" name="addruse">{{range $entry.Resource.Address}}{{.Use}} {{end}}</p>
        </div>
    </div>
    {{end}}
    {{template "horizontalline"}}
    <div class="row" style="color:blue;">
        <div class="col-sm-3">
            <label for="pid">Patient ID</label>
        </div>
        <div class="col-sm-9">
            <label for="authuid">ID Type</label>
        </div>
    </div>
    {{range $entry:= .PIXmResponse.Entry}} 
    {{range $entry.Resource.Identifier}}
    <div class="row">
         <div class="col-sm-3">
            <p id="pid" name="pid">{{.Value}}</p>
        </div>
        <div class="col-sm-9">
            <p id="authuid" name="authuid">{{$event.GetMappedId ($event.GetMappedId (splitfhiroid .System))}}</p>
        </div>
    </div>
    {{end}}
    {{end}}
    {{else}}
    <h3>Unable to connect to Patient Service. Some Patient Demographics are not available</h3>
    {{end}}
</div>
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:48:38.932092 main.go:193: Loaded subscriptions.html 
2022/11/23 16:48:38.932156 main.go:171: Persisting HTML Template subscriptions.html
2022/11/23 16:48:38.932228 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [subscriptions %!s(bool=false)]
2022/11/23 16:48:38.935682 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [subscriptions %!s(bool=false) {{define "subscriptions"}} 
{{ template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
{{$event:= .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <h4 style="color: blue; text-align:center">Event Service Broker Subscriptions</h3>
        </div>
    </div>
    {{template "horizontalline"}} 
    {{range $k,$v := .DBSubscriptions.Subscriptions}}
    {{ if ne $k 0 }}
    <div class="row">
        <div class="col-sm-2">
            <label for="expression">Created</label>
            <p id="expression" name="expression">{{$v.Created}}</p>
        </div>
        <div class="col-sm-2">
            <label for="expression">Pathway</label>
            <p id="expression" name="expression">{{$event.GetMappedId $v.Pathway}}</p>
        </div>
        <div class="col-sm-2">
            <label for="expression">Expression</label>
            <p id="expression" name="expression">{{$v.Expression}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-mb-2">
            <a href="{{$url}}?act=subscriber&task=cancel&id={{$v.Id}}&saml={{$event.SAML}}">
                <span><button class="btn btn-outline-primary btn-sm" type="button"></span>Cancel Subscription</button>
                </span>
            </a>
        </div>
        <div class="col-sm-10">
            <p id="expression" name="expression">{{$v.BrokerRef}}</p>
        </div>
    </div>
    {{template "horizontalline"}}
    {{end}}
    {{end}}
</div>
</body>
{{ template "footer"}} 
{{end}}]
2022/11/23 16:48:38.939378 main.go:193: Loaded workflowtasks.html 
2022/11/23 16:48:38.939411 main.go:171: Persisting HTML Template workflowtasks.html
2022/11/23 16:48:38.939444 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflowtasks %!s(bool=false)]
2022/11/23 16:48:38.942367 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflowtasks %!s(bool=false) {{define "workflowtasks"}}
    {{$event := .}}
    {{$nhsid := .NHSId}}
    {{$url := .EventServices.EventService.EventUrl}}
    {{$usr := .EventServices.EventService.User}}
    {{$org := .EventServices.EventService.Org}}
    {{$role := .EventServices.EventService.Role}}
    {{$pw:=.Pathway}}
    {{$exp:=.Expression}}
    {{$top:=.Topic}}
    {{template "header" .}} 
        <div id="tasksDIV">
            {{range $k,$t := .XDWWorkflowDocument.TaskList.XDWTask}}
            {{$overdue := $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                <div class="row">
                    <div class="col-sm-1">
                        <h5 style="color: darkblue;text-align: center;">Task {{.TaskData.TaskDetails.ID}}</h5>
                    </div>
                    <div class="col-sm-11">
                        <h5 style="color: darkblue;">{{.TaskData.Description}}</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-1">
                        {{template "snip_workflow_task_col_status" $t}}
                    </div>
                    <div class="col-sm-1">
                        <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                        {{if $overdue}}
                        <p style="color: red;" id="overdue" name="overdue">YES</p>
                        {{else}}
                        <p style="color: green;" id="overdue" name="overdue">NO</p>
                        {{end}}
                    </div>
                    <div class="col-sm-2">
                        <label style="text-align: center;color: darkblue" for="completeby">Complete By</label> 
                        {{if $overdue}}
                        <p style="color: red;" id="completeby" name="completeby">{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                        {{else}}
                        <p style="color: green;" id="completeby" name="completeby">{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                        {{end}}
                    </div>
                    <div class="col-sm-3">
                        <label style="text-align: center;color: darkblue">
                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                        Completed On
                        {{else}}
                        Last Update
                        {{end}}
                        </label>
                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                            <p style="color: green;">{{$t.TaskData.TaskDetails.LastModifiedTime}}</p>
                        {{else}}
                            <p>{{$t.TaskData.TaskDetails.LastModifiedTime}}</p>
                        {{end}}
                    </div>
                </div>
                {{template "horizontalline"}}
                {{if $t.TaskData.Input}} 
                    {{range $t.TaskData.Input}}
                        <div class="row">
                            {{if $event.IsBrokerExpression .Part.AttachmentInfo.Name}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="inputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} Actioned By {{.Part.AttachmentInfo.AttachedBy}} On {{.Part.AttachmentInfo.AttachedTime}}</p>
                                    {{else}}
                                        <a href="{{$url}}?act=events&task=create&pathway={{$event.Pathway}}&taskid={{$t.TaskData.TaskDetails.ID}}&vers={{$event.Vers}}&topic=addComment&expression={{.Part.AttachmentInfo.Name}}&notes=Demo simulation of DSUB Broker Notification&nhs={{$event.NHSId}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}" target="workflowItem" onclick="togglesidebar()"><label style="color: darkblue;" for="inputexpression"><i class="fa-solid fa-envelope-open"></i> Waiting for {{.Part.AttachmentInfo.Name}} to be Published</label></a>
                                    {{end}}
                                </div>
                            {{else}} 
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="inputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} is Actioned</p>
                                        <textarea disabled type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes">{{$event.TaskNotes $t.TaskData.TaskDetails.ID}}</textarea>
                                    {{else}} 
                                        <form action="{{$url}}" target="workflowItem">
                                            <input type="hidden" class="form-control" id="taskid" name="taskid" value={{$t.TaskData.TaskDetails.ID}}>
                                            <input type="hidden" class="form-control" id="vers" name="vers" value={{$event.Vers}}>
                                            <input type="hidden" class="form-control" id="saml" name="saml" value={{$event.SAML}}>
                                            <input type="hidden" class="form-control" id="act" name="act" value="events">
                                            <input type="hidden" class="form-control" id="task" name="task" value="create">
                                            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{$event.Pathway}}">
                                            <input type="hidden" class="form-control" id="nhs" name="nhs" value="{{$event.NHSId}}">
                                            <input type="hidden" class="form-control" id="user" name="user" value="{{$event.EventServices.EventService.User}}">
                                            <input type="hidden" class="form-control" id="org" name="org" value="{{$event.EventServices.EventService.Org}}">
                                            <input type="hidden" class="form-control" id="role" name="role" value="{{$event.EventServices.EventService.Role}}">
                                            <input type="hidden" class="form-control" id="topic" name="topic" value="addComment">
                                            <input type="hidden" class="form-control" id="expression" name="expression" value="{{.Part.AttachmentInfo.Name}}"> 
                                            <button type="submit" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-person-circle-check"></i> Create Event - {{.Part.AttachmentInfo.Name}} </button>
                                            <textarea type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes" placeholder={{$event.TaskNotes $t.TaskData.TaskDetails.ID}}></textarea> 
                                        </form>
                                        </br>
                                    {{end}}
                                </div>
                            {{end}}
                        </div>
                    {{end}}
                {{end}}
                </br>
                {{if $t.TaskData.Output}}
                    {{range $t.TaskData.Output}}
                        <div class="row">
                            {{if $event.IsBrokerExpression .Part.AttachmentInfo.Name}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="outputexpression" name="outputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} Actioned By {{.Part.AttachmentInfo.AttachedBy}} On {{.Part.AttachmentInfo.AttachedTime}}</p>
                                    {{else}}
                                        <a href="{{$url}}?act=events&task=create&pathway={{$event.Pathway}}&taskid={{$t.TaskData.TaskDetails.ID}}&vers={{$event.Vers}}&topic=addComment&expression={{.Part.AttachmentInfo.Name}}&notes=Demo simulation of DSUB Broker Notification&nhs={{$event.NHSId}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}" target="workflowItem" onclick="togglesidebar()"><label style="color: darkblue;" for="inputexpression"><i class="fa-solid fa-envelope-open"></i> Waiting for {{.Part.AttachmentInfo.Name}} to be Published</label></a>
                                    {{end}}
                                </div>
                            {{else}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="outputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} is Actioned</p>
                                        <textarea disabled type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes">{{$event.TaskNotes $t.TaskData.TaskDetails.ID}}</textarea>
                                    {{else}} 
                                        <form action="{{$url}}" target="workflowItem">
                                            <input type="hidden" class="form-control" id="taskid" name="taskid" value={{$t.TaskData.TaskDetails.ID}}>
                                            <input type="hidden" class="form-control" id="vers" name="vers" value={{$event.Vers}}>
                                            <input type="hidden" class="form-control" id="saml" name="saml" value={{$event.SAML}}>
                                            <input type="hidden" class="form-control" id="act" name="act" value="events">
                                            <input type="hidden" class="form-control" id="task" name="task" value="create">
                                            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{$event.Pathway}}">
                                            <input type="hidden" class="form-control" id="nhs" name="nhs" value="{{$event.NHSId}}">
                                            <input type="hidden" class="form-control" id="user" name="user" value="{{$event.EventServices.EventService.User}}">
                                            <input type="hidden" class="form-control" id="org" name="org" value="{{$event.EventServices.EventService.Org}}">
                                            <input type="hidden" class="form-control" id="role" name="role" value="{{$event.EventServices.EventService.Role}}">
                                            <input type="hidden" class="form-control" id="topic" name="topic" value="addComment">
                                            <input type="hidden" class="form-control" id="expression" name="expression" value="{{.Part.AttachmentInfo.Name}}">
                                            <button type="submit" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-person-circle-check"></i> Create Event - {{.Part.AttachmentInfo.Name}} </button>
                                            <textarea type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes" placeholder={{$event.TaskNotes $t.TaskData.TaskDetails.ID}}></textarea>
                                        </form>
                                        </br>
                                    {{end}}
                                </div>
                            {{end}}
                        </div>
                    {{end}}
                {{end}}
            {{template "horizontalline"}}
            {{end}}
        </div>
    </body>
    {{template "footer"}}
{{end}}]
2022/11/23 16:48:38.950190 main.go:193: Loaded dashboardwidget.html 
2022/11/23 16:48:38.950216 main.go:171: Persisting HTML Template dashboardwidget.html
2022/11/23 16:48:38.950244 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [dashboardwidget %!s(bool=false)]
2022/11/23 16:48:38.953468 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (isxml, template, name) VALUES (?, ?, ?) - Values [%!s(bool=false) {{define "dashboardwidget"}}
{{template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <img class="img-fluid left-block" src="/nhs-essex-trust-logo.jpeg" /></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <h1 style="color:darkblue;text-align: center;" class="center-block">{{.GetMappedId .Pathway}} Dashboard </h1>
        </div>
    </div>
    {{template "horizontalline"}}
    <div class="row text-center">
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-medkit fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Total}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text">Total</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-user-md fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.InProgress}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=open&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Open</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-thumbs-up fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Complete}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=closed&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Closed</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bullseye fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.TargetMet}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=met&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Target Met</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bell fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.TargetMissed}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=missed&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Target Missed</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bullhorn fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Escalated}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=escalated&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Require Escalation</p>
                </a>
            </div>
        </div>
    </div>
    <div id="dashboardItemDIV">
        <iframe scrolling="auto" margin="0" frameBorder="0" height="150px" width="100%" id="dashboardItem" name="dashboardItem" src="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}"></iframe>
    </div>
    <div id="workflowItemDIV">
        <iframe scrolling="auto" margin="0" frameBorder="0" height="500px" width="100%" id="workflowItem" name="workflowItem"></iframe>
    </div>
</body>
    <script>
        (function($) {
            $.fn.countTo = function(options) {
                options = options || {};

                return $(this).each(function() {
                    // set options for current element
                    var settings = $.extend({}, $.fn.countTo.defaults, {
                        from: $(this).data('from'),
                        to: $(this).data('to'),
                        speed: $(this).data('speed'),
                        refreshInterval: $(this).data('refresh-interval'),
                        decimals: $(this).data('decimals')
                    }, options);

                    // how many times to update the value, and how much to increment the value on each update
                    var loops = Math.ceil(settings.speed / settings.refreshInterval),
                        increment = (settings.to - settings.from) / loops;

                    // references & variables that will change with each update
                    var self = this,
                        $self = $(this),
                        loopCount = 0,
                        value = settings.from,
                        data = $self.data('countTo') || {};

                    $self.data('countTo', data);

                    // if an existing interval can be found, clear it first
                    if (data.interval) {
                        clearInterval(data.interval);
                    }
                    data.interval = setInterval(updateTimer, settings.refreshInterval);

                    // initialize the element with the starting value
                    render(value);

                    function updateTimer() {
                        value += increment;
                        loopCount++;

                        render(value);

                        if (typeof(settings.onUpdate) == 'function') {
                            settings.onUpdate.call(self, value);
                        }

                        if (loopCount >= loops) {
                            // remove the interval
                            $self.removeData('countTo');
                            clearInterval(data.interval);
                            value = settings.to;

                            if (typeof(settings.onComplete) == 'function') {
                                settings.onComplete.call(self, value);
                            }
                        }
                    }

                    function render(value) {
                        var formattedValue = settings.formatter.call(self, value, settings);
                        $self.html(formattedValue);
                    }
                });
            };

            $.fn.countTo.defaults = {
                from: 0, // the number the element should start at
                to: 0, // the number the element should end at
                speed: 1000, // how long it should take to count between the target numbers
                refreshInterval: 100, // how often the element should be updated
                decimals: 0, // the number of decimal places to show
                formatter: formatter, // handler for formatting the value before rendering
                onUpdate: null, // callback method for every time the element is updated
                onComplete: null // callback method for when the element finishes updating
            };

            function formatter(value, settings) {
                return value.toFixed(settings.decimals);
            }
        }(jQuery));

        jQuery(function($) {
            // custom formatting example
            $('.count-number').data('countToOptions', {
                formatter: function(value, options) {
                    return value.toFixed(options.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g, ',');
                }
            });

            // start all the timers
            $('.timer').each(count);

            function count(options) {
                var $this = $(this);
                options = $.extend({}, options || {}, $this.data('countToOptions') || {});
                $this.countTo(options);
            }
        });
    </script>
    <script>
        window.setInterval('refresh()', '{{.Op}}');

        function refresh() {
            window.location.reload();
        }
    </script>
{{template "footer" .}}
{{end}} dashboardwidget]
2022/11/23 16:48:38.959130 main.go:193: Loaded snip_workflow_header.html 
2022/11/23 16:48:38.959158 main.go:171: Persisting HTML Template snip_workflow_header.html
2022/11/23 16:48:38.959186 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [snip_workflow_header %!s(bool=false)]
2022/11/23 16:48:38.963395 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (template, name, isxml) VALUES (?, ?, ?) - Values [{{define "snip_workflow_header"}}
<div class="container-fluid">
    <div class="center-block">
        <div class="row">
            <div class="col-sm-1">
                <label style="text-align: center;color: darkblue" for="conf">Conf Code</label>
                <p id="conf" name="conf">{{.WorkflowDefinition.Confidentialitycode}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="user">Opened By</label>
                <p id="user" name="user">{{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Prefix}} {{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Family}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="lupdt">Last Update</label>
                <p id="lupdt" name="lupdt">{{.PrettyTime .LastUpdateTime}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="comby">Complete By</label>
                <p id="comby" name="comby">{{.PrettyTime .CompletionTime}}</p>
            </div>
            <div class="col-sm-1">
                {{if .IsWorkflowOverdue}}
                <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                <p id="overdue" name="overdue" style="color: rgb(255, 170, 0)"><i class="fa fa-thumbs-down"></i> YES</p>
                {{else}}
                <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                <p id="overdue" name="overdue" style="color: green"><i class="fa fa-thumbs-up"></i> NO</p>
                {{end}}
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="elapsedtime">Elapsed Time</label>
                 {{if .IsWorkflowOverdue}}
                    <p style="color: darkorange;" id="elapsedtime" name="elapsedtime">{{.Elapsedtime}}</p>
                {{else}}
                    <p style="color: green;" id="elapsedtime" name="elaspedtime">{{.Elapsedtime}}</p>
                {{end}}
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="timeleft">Time Remaining</label>
                <p id="timeleft" name="timeleft">{{.WorkflowTimeRemaining}}</p>
            </div>
        </div>
    </div>
</div>

{{end}} snip_workflow_header %!s(bool=false)]
2022/11/23 16:48:38.966923 main.go:193: Loaded workflows.html 
2022/11/23 16:48:38.966950 main.go:171: Persisting HTML Template workflows.html
2022/11/23 16:48:38.966987 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflows %!s(bool=false)]
2022/11/23 16:48:38.970379 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflows %!s(bool=false) {{define "workflows"}} 
{{ template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
{{$saml:= .SAML}}
{{$usr := .EventServices.EventService.User}}
{{$org := .EventServices.EventService.Org}}
{{$role := .EventServices.EventService.Role}}
{{$pw := .Pathway}}
{{$nhsid := .NHSId}}
{{$event := .}}
<div class="container-fluid">
    {{template "horizontalline"}}
    <div class="row">
        <div class="col-sm-12">
            <h3 style="text-align:center;color:darkblue">{{len .XDWDocuments}} {{.Status}} {{.GetMappedId $pw}}{{$nhsid}} Workflows</h3>
        </div>
    </div>
    {{range .XDWDocuments}}
    <div class="row">
        <div class="col-sm-1">
            <label style="color:darkblue" for="nhsid">NHS ID</label>
            <p id="nhsid" name="nhsid">{{.NHSId}}</p>
        </div>
       <div class="col-sm-2">
            <label style="color:darkblue" for="pwy">Pathway</label>
            <p id="pwy" name="pwy">{{$event.GetMappedId .Pathway}}</p>
        </div>
         <div class="col-sm-2">
            <label style="color:darkblue" for="created">Opened</label>
            <p id="created" name="created">{{$event.PrettyTime .Created}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:darkblue" for="xdwkey">XDW Key</label>
            <p id="xdwkey" name="xdwkey">{{.XDW_Key}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="status">Status</label>
            <p id="status" name="status">{{.Status}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="published">Published</label>
            <p id="published" name="published">{{.Published}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="version">Version</label>
            <a href="{{$url}}?act=widget&task=xdw&pathway={{.Pathway}}&nhs={{.NHSId}}&vers={{.Version}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="workflowItem"><p id="version" name="version">{{.Version}}</p></a>
        </div>
        {{if eq .Status "CLOSED"}}
        <div class="col-sm-2">
            <label style="color:darkblue" for="duration">Workflow Duration</label>
            <p id="version" name="version">{{$event.ElapsedTime .}}</p></a>
        </div>
        {{end}}
    </div>
    {{template "horizontalline"}}
    {{end}}
</div>    
</tbody>
{{ template "footer"}} 
{{end}}]
2022/11/23 16:48:38.977365 main.go:193: Loaded adminspawidget.html 
2022/11/23 16:48:38.977425 main.go:171: Persisting HTML Template adminspawidget.html
2022/11/23 16:48:38.977462 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [adminspawidget %!s(bool=false)]
2022/11/23 16:48:38.980856 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [adminspawidget %!s(bool=false) {{define "adminspawidget"}}
{{$saml := .SAML}}
{{$url:= .EventServices.EventService.EventUrl}}
{{$nhsid:=.NHSId}}{{$usr:=.EventServices.EventService.User}}{{$org:=.EventServices.EventService.Org}}{{$role:=.EventServices.EventService.Role}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/style.css">

    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js" integrity="sha512-yFjZbTYRCJodnuyGlsKamNE/LlEaEAxSUDe5+u61mV8zzqJVFOH7TnULE2/PP/l5vKWpUNnF4VGVkXh3MjgLsg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar">
            <ul class="list-unstyled components">
                <li>
                    <a href="{{$url}}?act=widget&task=dashboard&op=600000&pathway={{.Pathway}}&nhs={{.NHSId}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="iadmin" onclick="togglesidebar()">Pathways Dashboard</a>
                </li>
                <hr></hr>
                <li>
                    <a href="{{$url}}?act=subscriber&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="iadmin" onclick="togglesidebar()">Manage Subscriptions</a>
                </li>
                <hr></hr>
                <li>
                    <a href="{{$url}}?act=admin&task=restart&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Restart Service</a>
                </li>
                <hr></hr>
                <li>
                    <a href="#updatesmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Update</a>
                    <ul class="collapse list-unstyled" id="updatesmenu">
                        <li>
                            <a href="{{$url}}?act=admin&task=initsrvcs&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Service Configs</a>
                        </li>
                        <li>
                            <a href="{{$url}}?act=admin&task=inittmplts&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Templates</a>
                        </li>
                        <li>
                            <a href="{{$url}}?act=admin&task=initxdws&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">XDW Configs</a>
                        </li>
                    </ul>
                </li>
                <hr></hr>
                <li>
                    <a href="#configsmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Configure</a>
                    <ul class="collapse list-unstyled" id="configsmenu">
                        <li>
                            <a href="#configsrvcsmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Services</a>
                            <ul class="collapse list-unstyled" id="configsrvcsmenu">
                                {{range .EventServices.ServiceConfigs}}
                                <li><a href="{{$url}}?act=services&task=get&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configxmlmsgmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Messages</a>
                            <ul class="collapse list-unstyled" id="configxmlmsgmenu">
                                {{range .EventServices.XMLMessages}}
                                <li><a href="{{$url}}?act=services&task=getxml&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configwidgetmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">HTML</a>
                            <ul class="collapse list-unstyled" id="configwidgetmenu">
                                {{range .EventServices.HTMLWidgets}}
                                <li><a href="{{$url}}?act=services&task=gethtml&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configxdwmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Pathways</a>
                            <ul class="collapse list-unstyled" id="configxdwmenu">
                                {{range .EventServices.WorkflowDefinitions}}
                                <li><a href="{{$url}}?act=services&task=getxdw&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#initsrvcs" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDS Meta</a>
                            <ul class="collapse list-unstyled" id="initsrvcs">
                                {{range .EventServices.WorkflowXDWMeta}}
                                <li><a href="{{$url}}?act=services&task=getmeta&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div id="content">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i> Admin                       
                    </button>
                </div>
            </nav>
        </div>
        <div class="col-sm-12">
            <iframe onload="window.top.scrollTo(0,0);" frameborder="0" onload="resizeIframe(this)" style="width:100%;height: 100%;" name="iadmin" id="iadmin"></iframe>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<script>
    $(document).ready(function() {
        $('#sidebarCollapse').on('click', function() {
            $('#sidebar').toggleClass('active');
        });
        $('#sidebar').toggleClass('active');
    });
</script>
<script>
    function togglesidebar() {
        $('#sidebar').toggleClass('active');
    }
</script>
<style>
    .wrapper {
        display: flex;
        align-items: stretch;
    }
    
    #sidebar {
        min-width: 250px;
        max-width: 250px;
        min-height: 100vh;
        background: #7386D5;
        color: #fff;
        transition: all 0.3s;
    }
    
    #sidebar.active {
        margin-left: -250px;
    }
    
    #sidebar .sidebar-header {
        padding: 20px;
        background: #6d7fcc;
    }
    
    #sidebar ul.components {
        padding: 20px 0;
        border-bottom: 1px solid #47748b;
    }
    
    #sidebar ul p {
        color: #fff;
        padding: 10px;
    }
    
    #sidebar ul li a {
        padding: 10px;
        font-size: 1.1em;
        display: block;
    }
    
    #sidebar ul li a:hover {
        color: #7386D5;
        background: #fff;
    }
    
    #sidebar ul li.active>a,
    a[aria-expanded="true"] {
        color: #fff;
        background: #6d7fcc;
    }
    
    ul ul a {
        font-size: 0.9em !important;
        padding-left: 30px !important;
        background: #6d7fcc;
    }
    
    a[data-toggle="collapse"] {
        position: relative;
    }
    
    .dropdown-toggle::after {
        display: block;
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
    }
    
    @media (max-width: 768px) {
        #sidebar {
            margin-left: -250px;
        }
        #sidebar.active {
            margin-left: 0;
        }
    }
</style>

</html>
{{end}}]
2022/11/23 16:48:38.985294 main.go:193: Loaded spawidget.html 
2022/11/23 16:48:38.985323 main.go:171: Persisting HTML Template spawidget.html
2022/11/23 16:48:38.985350 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [spawidget %!s(bool=false)]
2022/11/23 16:48:38.989395 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [spawidget %!s(bool=false) {{define "spawidget"}}
{{$url:= .EventServices.EventService.EventUrl}}
{{$pwy:= .Pathway}}
{{$nhsid:= .NHSId}}
{{$usr:= .EventServices.EventService.User}}
{{$org:= .EventServices.EventService.Org}}
{{$role:= .EventServices.EventService.Role}}
{{$event := .}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/style.css">

    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js" integrity="sha512-yFjZbTYRCJodnuyGlsKamNE/LlEaEAxSUDe5+u61mV8zzqJVFOH7TnULE2/PP/l5vKWpUNnF4VGVkXh3MjgLsg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar">
            <ul class="list-unstyled components">
                <li>
                    <a href="#pathwaymenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDW Consumer</a>
                    <ul class="collapse list-unstyled" id="pathwaymenu">
                        {{range .EventServices.ActivePathways}}
                            <li onclick="togglesidebar()"><a href="{{$url}}?act=widget&task=dashboard&vers=-1&op=600000&pathway={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">{{$event.GetMappedId .}}</a></li>
                        {{end}}
                    </ul>
                </li>
                 <li>
                    <a href="#newxdwmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDW Creator</a>
                    <ul class="collapse list-unstyled" id="newxdwmenu">
                        {{range .EventServices.WorkflowDefinitions}}
                            <li><a href="{{$url}}?act=XDW_Creator&task=getworkflow&pathway={{.}}&nhs={{$nhsid}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent" onclick="togglesidebar()">{{.}} Workflow</a></li>
                        {{end}}
                    </ul>
                </li>
                <li onclick="togglesidebar()"><a href="{{$url}}?act=widget&task=dashboard&vers=-1&op=600000&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">XDW Dashboard</a></li>
                <li onclick="togglesidebar()"><a href="{{$url}}?act=admin&vers=-1&op=600000&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">XDW Admin</a></li>
            </ul>
        </nav>
        <div id="content">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-outline-primary btn-sm"><i class="fas fa-align-left"></i></button>
                </div>
            </nav>
        </div>
         <div class="col-sm-12">
            <iframe onload="window.top.scrollTo(0,0);" width="100%" height="100%" frameborder="0" name="spacontent" title="spacontent" id="spacontent" src="{{$url}}?act=widget&task=dashboard&pathway={{.Pathway}}&vers=-1&op=600000&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{$event.SAML}}"></iframe>
        </div>
    </div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<script>
    $(document).ready(function() {
        $('#sidebarCollapse').on('click', function() {
            $('#sidebar').toggleClass('active');
        });
        togglesidebar()
    });
</script>
<script>
    function togglesidebar() {
        $('#sidebar').toggleClass('active');
    }
</script>
<style>
    .wrapper {
        display: flex;
        align-items: stretch;
    }
    
    #sidebar {
        min-width: 250px;
        max-width: 250px;
        min-height: 100vh;
        background: #d8dbe7;
        color: rgb(0, 0, 0);
        transition: all 0.3s;
    }
    
    #sidebar.active {
        margin-left: -250px;
    }
    
    #sidebar .sidebar-header {
        padding: 20px;
        background: #cfd6f3;
    }
    
    #sidebar ul.components {
        padding: 20px 0;
        border-bottom: 1px solid #96acb8;
    }
    
    #sidebar ul p {
        color: rgb(5, 5, 5);
        padding: 3px;
    }
    
    #sidebar ul li a {
        padding: 10px;
        font-size: 1.1em;
        display: block;
    }
    
    #sidebar ul li a:hover {
        color: #f6f7fa;
        background: rgb(72, 179, 250);
    }
    
    #sidebar ul li.active>a,
    a[aria-expanded="true"] {
        color: rgb(2, 2, 2);
        background: #6d7fcc;
    }
    
    ul ul a {
        font-size: 0.9em !important;
        padding-left: 30px !important;
        background: #b0b9e0;
    }
    
    a[data-toggle="collapse"] {
        position: relative;
    }
    
    .dropdown-toggle::after {
        display: block;
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
    }
    
    @media (max-width: 768px) {
        #sidebar {
            margin-left: -250px;
        }
        #sidebar.active {
            margin-left: 0;
        }
    }
</style>

</html>
{{end}}]
2022/11/23 16:48:38.993971 main.go:193: Loaded footer.html 
2022/11/23 16:48:38.993997 main.go:171: Persisting HTML Template footer.html
2022/11/23 16:48:38.994024 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [footer %!s(bool=false)]
2022/11/23 16:48:38.996482 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (template, name, isxml) VALUES (?, ?, ?) - Values [{{define "footer"}}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>
<script>
    function openNav() {
        document.getElementById("mySidenav").style.width = "250px";
    }

    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
    }
</script>

</body>
<style>
    /* Timeline */
    
    .timeline,
    .timeline-horizontal {
        list-style: none;
        padding: 10px;
        position: relative;
    }
    
    .timeline:before {
        top: 20px;
        bottom: 0;
        position: absolute;
        content: " ";
        width: 3px;
        background-color: #eeeeee;
        left: 50%;
        margin-left: -1.5px;
    }
    
    .timeline .timeline-item {
        margin-bottom: 10px;
        position: relative;
    }
    
    .timeline .timeline-item:before,
    .timeline .timeline-item:after {
        content: "";
        display: table;
    }
    
    .timeline .timeline-item:after {
        clear: both;
    }
    
    .timeline .timeline-item .timeline-badge {
        color: #fff;
        width: 54px;
        height: 54px;
        line-height: 52px;
        font-size: 10px;
        text-align: center;
        position: absolute;
        top: 18px;
        left: 50%;
        margin-left: -25px;
        background-color: #7c7c7c;
        border: 3px solid #ffffff;
        z-index: 100;
        border-top-right-radius: 50%;
        border-top-left-radius: 50%;
        border-bottom-right-radius: 50%;
        border-bottom-left-radius: 50%;
    }
    
    .timeline .timeline-item .timeline-badge i,
    .timeline .timeline-item .timeline-badge .fa,
    .timeline .timeline-item .timeline-badge .glyphicon {
        top: 2px;
        left: 2px;
    }
    
    .timeline .timeline-item .timeline-badge.primary {
        background-color: #1f9eba;
    }
    
    .timeline .timeline-item .timeline-badge.info {
        background-color: #5bc0de;
    }
    
    .timeline .timeline-item .timeline-badge.success {
        background-color: #59ba1f;
    }
    
    .timeline .timeline-item .timeline-badge.warning {
        background-color: #d1bd10;
    }
    
    .timeline .timeline-item .timeline-badge.danger {
        background-color: #ba1f1f;
    }
    
    .timeline .timeline-item .timeline-panel {
        position: relative;
        width: 45%;
        float: left;
        right: 10px;
        border: 1px solid #c0c0c0;
        background: #ffffff;
        border-radius: 2px;
        padding: 10px;
        -webkit-box-shadow: 0 1px 6px rgba(0, 0, 0, 0.175);
        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.175);
    }
    
    .timeline .timeline-item .timeline-panel:before {
        position: absolute;
        top: 26px;
        right: -16px;
        display: inline-block;
        border-top: 16px solid transparent;
        border-left: 16px solid #c0c0c0;
        border-right: 0 solid #c0c0c0;
        border-bottom: 16px solid transparent;
        content: " ";
    }
    
    .timeline .timeline-item .timeline-panel .timeline-title {
        margin-top: 5px;
        color: inherit;
    }
    
    .timeline .timeline-item .timeline-panel .timeline-body>p,
    .timeline .timeline-item .timeline-panel .timeline-body>ul {
        margin-bottom: 0;
        margin-left: 10px;
    }
    
    .timeline .timeline-item .timeline-panel .timeline-body>p+p {
        margin-top: 5px;
    }
    
    .timeline .timeline-item:last-child:nth-child(even) {
        float: none;
    }
    
    .timeline .timeline-item:nth-child(even) .timeline-panel {
        float: right;
        left: 5px;
    }
    
    .timeline .timeline-item:nth-child(even) .timeline-panel:before {
        border-left-width: 0;
        border-right-width: 14px;
        left: -14px;
        right: auto;
    }
    
    .timeline-horizontal {
        list-style: none;
        position: relative;
        padding: 5px 0px 5px 0px;
        display: inline-block;
    }
    
    .timeline-horizontal:before {
        height: 3px;
        top: auto;
        bottom: 26px;
        left: 16px;
        right: 0;
        width: 100%;
        margin-bottom: 20px;
    }
    
    .timeline-horizontal .timeline-item {
        display: table-cell;
        height: 280px;
        width: 20%;
        min-width: 320px;
        float: none !important;
        padding-left: 0px;
        padding-right: 20px;
        margin: 0 auto;
        vertical-align: bottom;
    }
    
    .timeline-horizontal .timeline-item .timeline-panel {
        top: auto;
        bottom: 64px;
        display: inline-block;
        float: none !important;
        left: 0 !important;
        right: 0 !important;
        width: 100%;
        margin-bottom: 20px;
    }
    
    .timeline-horizontal .timeline-item .timeline-panel:before {
        top: auto;
        bottom: -16px;
        left: 28px !important;
        right: auto;
        border-right: 16px solid transparent !important;
        border-top: 16px solid #c0c0c0 !important;
        border-bottom: 0 solid #c0c0c0 !important;
        border-left: 16px solid transparent !important;
    }
    
    .timeline-horizontal .timeline-item:before,
    .timeline-horizontal .timeline-item:after {
        display: none;
    }
    
    .timeline-horizontal .timeline-item .timeline-badge {
        top: auto;
        bottom: 0px;
        left: 43px;
    }
    
    .counter {
        background-color: #f5f5f5;
        padding: 10px 0;
        border-radius: 5px;
    }
    
    .count-title {
        font-size: 30px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }
    
    .count-text {
        font-size: 20px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }
    
    .fa-2x {
        margin: 0 auto;
        float: none;
        display: table;
        color: #4ad1e5;
    }
    
    .loader-wrapper {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        background-color: #242f3f;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .loader {
        display: inline-block;
        width: 100px;
        height: 100px;
        position: relative;
        border: 4px solid #Fff;
        animation: loader 2s infinite ease;
    }
    
    .loader-inner {
        vertical-align: top;
        display: inline-block;
        width: 100%;
        background-color: #fff;
        animation: loader-inner 2s infinite ease-in;
    }
    
    @keyframes loader {
        0% {
            transform: rotate(0deg);
        }
        25% {
            transform: rotate(180deg);
        }
        50% {
            transform: rotate(180deg);
        }
        75% {
            transform: rotate(360deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
    
    @keyframes loader-inner {
        0% {
            height: 0%;
        }
        25% {
            height: 0%;
        }
        50% {
            height: 100%;
        }
        75% {
            height: 100%;
        }
        100% {
            height: 0%;
        }
    }
    
    .sidenav {
        display: none;
        height: 100%;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        background-color: #111;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 60px;
    }
    
    .sidenav a {
        padding: 8px 8px 8px 32px;
        text-decoration: none;
        font-size: 25px;
        color: #818181;
        display: block;
        transition: 0.3s;
    }
    
    .sidenav a:hover {
        color: #f1f1f1;
    }
    
    .sidenav .closebtn {
        position: absolute;
        top: 0;
        right: 15px;
        font-size: 36px;
        margin-left: 50px;
    }
    
    @media screen and (max-height: 450px) {
        .sidenav {
            padding-top: 15px;
        }
        .sidenav a {
            font-size: 18px;
        }
    }
    
    .item .item-content {
        padding: 30px 35px
    }
    
    .image-upload {
        width: 100%;
        height: 100px;
        border: 1px dashed #ddd;
        border-radius: 5px;
        margin-bottom: 20px;
        position: relative;
        text-align: center;
        background: #f8f8f9;
        color: #666;
        overflow: hidden
    }
    
    .item-wrapper form img {
        margin-bottom: 20px;
        width: auto;
        height: auto;
        max-height: 400px;
        width: auto;
        border-radius: 5px;
        overflow: hidden
    }
    
    .image-upload img {
        height: 100% !important;
        width: auto !important;
        border-radius: 0px;
        margin: 0 auto
    }
    
    .image-upload i {
        font-size: 6em;
        color: rgb(62, 25, 133)
    }
    
    .image-upload input {
        cursor: pointer;
        opacity: 0;
        height: 100%;
        width: 100%;
        z-index: 10;
        position: absolute;
        top: 0;
        left: 0
    }
    
    .item-wrapper input {
        height: 43px;
        line-height: 43px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 20px
    }
    
    .wrapper {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: stretch;
        justify-content: center;
    }
    
    .file-upload {
        height: 200px;
        width: 300px;
        border-radius: 100px;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        border: 4px solid #FFFFFF;
        overflow: hidden;
        background-image: linear-gradient(to bottom, #2590EB 50%, #FFFFFF 50%);
        background-size: 100% 200%;
        transition: all 1s;
        color: #0bd659;
        font-size: 75px;
    }
    
    .hidden {
        display: none;
    }
</style>

</html>{{end}} footer %!s(bool=false)]
2022/11/23 16:48:38.999155 main.go:193: Loaded events.html 
2022/11/23 16:48:38.999186 main.go:171: Persisting HTML Template events.html
2022/11/23 16:48:38.999213 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [events %!s(bool=false)]
2022/11/23 16:48:39.002521 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (template, name, isxml) VALUES (?, ?, ?) - Values [{{define "events"}} 
{{template "header" .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <h3 style="text-align:center;color:darkblue">{{.Pathway}} {{len .DBEvents}} Events</h3>
        </div>
    </div>
    {{range .DBEvents}}
        {{if ne .Id 0}}
        <div class="row">
                <div class="col-sm-2">
                <label style="color:darkblue" for="pathway">Pathway</label>
                <p id="pathway" name="pathway">{{.Pathway}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="expression">Event</label>
                <p id="expression" name="expression">{{.Expression}}</p>
            </div>
            <div class="col-sm-1">
                <label style="color:darkblue" for="topic">Task</label>
                <p id="topic" name="topic">{{.TaskId}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="authors">Created By</label>
                <p id="authors" name="authors">{{.Authors}}</p>
            </div>
            <div class="col-sm-1">
                <label style="color:darkblue" for="nhs">For Patient</label>
                <p id="nhs" name="nhs">{{.NhsId}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="created">Created</label>
                <p id="created" name="created">{{.Creationtime}}</p>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <label style="color:darkblue" for="notes">Notes</label>
                <textarea disabled id="notes" name="notes">{{.Comments}}</textarea>
            </div>
        </div>
        {{template "horizontalline"}}
        {{end}}
    {{end}}
</div>
</body>
{{template "footer"}}
{{end}} events %!s(bool=false)]
2022/11/23 16:48:39.006439 main.go:193: Loaded header.html 
2022/11/23 16:48:39.006475 main.go:171: Persisting HTML Template header.html
2022/11/23 16:48:39.006526 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [header %!s(bool=false)]
2022/11/23 16:48:39.010327 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [header %!s(bool=false) {{define "header"}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link rel="stylesheet" href="/eventservice.css">
    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/solid.min.css" integrity="sha512-LUxUs00S05YspUb2HCuUTBqTqbjJm2uNvwRXVTcl/jkr9ygYZptXhfknc52iBnPUNgHHHC9ivU4RV6UFxLxhfg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/js/all.min.js" integrity="sha512-Cvxz1E4gCrYKQfz6Ne+VoDiiLrbFBvc6BPh4iyKo2/ICdIodfgc5Q9cBjRivfQNUXBCEnQWcEInSXsvlNHY/ZQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <script defer src="https://use.fontawesome.com/releases/v6.0.1/js/solid.js " integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ " crossorigin="anonymous "></script>
    <script defer src="https://use.fontawesome.com/releases/v6.0.1/js/fontawesome.js " integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY " crossorigin="anonymous "></script> -->

    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js "></script>
</head>

<body>

    {{end}}]
2022/11/23 16:48:39.014345 main.go:193: Loaded pixpatient.html 
2022/11/23 16:48:39.014381 main.go:171: Persisting HTML Template pixpatient.html
2022/11/23 16:48:39.014416 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [pixpatient %!s(bool=false)]
2022/11/23 16:48:39.017023 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [pixpatient %!s(bool=false) {{define "pixpatient"}}
{{template "header" .}} 
{{$pat := .PDQv3Response.Body.PRPAIN201306UV02.ControlActProcess.Subject.RegistrationEvent.Subject1.Patient}}
{{template "horizontalline"}}
{{$event := .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <a href="#" onclick="togglePatient()"><i class="fa fa-bars">Toggle</i></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-1">
            <label style="color:blue;" for="givenname">Given</label>
            <p id="givenname" name="givenname">{{$pat.PatientPerson.Name.Given}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="familyname">Family</label>
            <p id="familyname" name="familyname">{{$pat.PatientPerson.Name.Family}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="dob">Birth Date</label>
            <p id="dob" name="dob">{{$pat.PatientPerson.BirthTime}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="gender">Gender</label>
            <p id="gender" name="gender">{{$pat.PatientPerson.AdministrativeGenderCode.Code}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="maritalStatusCode">Marital Status</label>
            <p id="maritalStatusCode" name="maritalStatusCode">{{$pat.PatientPerson.MaritalStatusCode.Code}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="twin">Twin</label>
            <p id="twin" name="twin">{{$pat.PatientPerson.MultipleBirthInd}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="telecom">Telcom</label>
            {{range $pat.PatientPerson.Telecom}}
            <p id="telecom" name="telecom">{{.Value}}</p>
            {{end}}
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="updated">Last Updated</label>
            <p id="updated" name="updated">{{$pat.EffectiveTime.Value}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="address">Address</label>
            <p id="address" name="address">{{$pat.PatientPerson.Addr.StreetAddressLine}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="city">City</label>
            <p id="city" name="city">{{$pat.PatientPerson.Addr.City}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="state">State</label>
            <p id="state" name="state">{{$pat.PatientPerson.Addr.State}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="zip">ZIP</label>
            <p id="zip" name="zip">{{$pat.PatientPerson.Addr.PostalCode}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="deceased">Deceased</label>
            <p id="deceased" name="deceased">{{$pat.PatientPerson.DeceasedInd}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="nat">Nat</label>
            <p id="nat" name="nat">{{$pat.PatientPerson.AsCitizen.PoliticalNation.Code.Code}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="birthplace">Birth Place</label>
            <p id="birthplace" name="birthplace">{{$pat.PatientPerson.BirthPlace.Addr.City}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="pid">Patient ID</label>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="idtype">ID Type</label>
        </div>
    </div>
    {{range $pat.ID}}
    <div class="row">
        <div class="col-sm-2">
            <p id="pid" name="pid">{{.Extension}}</p>
        </div>
        <div class="col-sm-2">
            <p id="idtype" name="idtype">{{$event.GetMappedId .AssigningAuthorityName}}</p>
        </div>
    </div>
    {{end}} 
</div>
{{template "footer"}} {{end}}]
2022/11/23 16:48:39.021407 main.go:193: Loaded horizontalline.html 
2022/11/23 16:48:39.021444 main.go:171: Persisting HTML Template horizontalline.html
2022/11/23 16:48:39.021482 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [horizontalline %!s(bool=false)]
2022/11/23 16:48:39.024507 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (isxml, template, name) VALUES (?, ?, ?) - Values [%!s(bool=false) {{define "horizontalline"}}
<div class="row">
    <div class="col-sm-12">
        <hr></hr>
    </div>
</div>
{{end}} horizontalline]
2022/11/23 16:48:39.027605 main.go:193: Loaded workflow.html 
2022/11/23 16:48:39.027630 main.go:171: Persisting HTML Template workflow.html
2022/11/23 16:48:39.027658 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflow %!s(bool=false)]
2022/11/23 16:48:39.031817 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (isxml, template, name) VALUES (?, ?, ?) - Values [%!s(bool=false) {{define "workflow"}}
{{template "header" .}}
{{template "snip_workflow_header" .}}
{{template "timelinewidget" .}}
</body>
{{template "footer"}}
{{end}} workflow]
2022/11/23 16:48:39.035195 main.go:193: Loaded wfconfig.html 
2022/11/23 16:48:39.035230 main.go:171: Persisting HTML Template wfconfig.html
2022/11/23 16:48:39.035265 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [wfconfig %!s(bool=false)]
2022/11/23 16:48:39.038516 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [wfconfig %!s(bool=false) {{define "wfconfig"}}
{{template "header"}}
{{$url := .EventServices.EventService.EventUrl}}
<div class="container-fluid">
    <h3>{{if eq .Task "get"}}
         Service 
        {{end}} 
        {{if eq .Task "getxdw"}} 
         Pathway 
        {{end}} 
        {{if eq .Task "getmeta"}}
         XDS Meta 
        {{end}}
        {{if eq .Task "gethtml"}}
         HTML Widget 
        {{end}} 
        {{if eq .Task "getworkflow"}}
         Workflow  
        {{end}} 
        Configuration</h3>
    <form action="{{$url}}" target="iadmin">
        <div class="row">
            <input type="hidden" class="form-control" id="saml" name="saml" value={{.SAML}}>
            <input type="hidden" class="form-control" id="act" name="act" value="{{.Act}}">
            {{if eq .Task "get"}}
            <input type="hidden" class="form-control" id="task" name="task" value="set">
            {{end}}
            {{if eq .Task "getmeta"}}
            <input type="hidden" class="form-control" id="task" name="task" value="setmeta"> 
            {{end}}
            {{if eq .Task "getxdw"}}
            <input type="hidden" class="form-control" id="task" name="task" value="setxdw"> 
            {{end}}
            {{if eq .Task "gethtml"}}
            <input type="hidden" class="form-control" id="task" name="task" value="sethtml"> 
            {{end}}
            <input type="hidden" class="form-control" id="op" name="op" value="{{.Op}}">
            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{.Pathway}}">
            <input type="hidden" class="form-control" id="user" name="user" value="{{.EventServices.EventService.User}}">
            <input type="hidden" class="form-control" id="org" name="org" value="{{.EventServices.EventService.Org}}">
            <input type="hidden" class="form-control" id="role" name="role" value="{{.EventServices.EventService.Role}}">
        </div>
        <div class="row">
            <div class="col-sm-12 ">
                <hr></hr>
            </div>
        </div>
        {{if ne .Task "getworkflow"}}
            <textarea type="input" class="form-control" id="config" name="config" rows="25">{{.ConfigStr}}</textarea>
        {{else}}
            <textarea disabled type="input" class="form-control" id="config" name="config" rows="25">{{.ConfigStr}}</textarea>
        {{end}}
        <p> </p>
        {{if ne .Task "getworkflow"}}
            <button type="submit" class="btn btn-primary sm-2">Update</button>
        {{else}}
            <button disabled type="submit" class="btn btn-primary sm-2">Update</button>
        {{end}}
    </form>
</div>
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:48:39.041418 main.go:193: Loaded timelinewidget.html 
2022/11/23 16:48:39.041454 main.go:171: Persisting HTML Template timelinewidget.html
2022/11/23 16:48:39.041489 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [timelinewidget %!s(bool=false)]
2022/11/23 16:48:39.044037 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (template, name, isxml) VALUES (?, ?, ?) - Values [{{define "timelinewidget"}}
{{$event := .}}
{{$vers := .Vers}}
<div class="center-block">
    <div class="row">
        <div class="col-sm-12">
            <h5 style="text-align:center;color:darkblue">{{.GetMappedId .Pathway}} Timeline for {{.NHSId}} Version {{.Vers}}</h5>
        </div>
    </div>
    {{template "horizontalline"}}
    <div class="row">
        <div class="col-sm-12">
            <div style="display:inline-block;width:100%;overflow-y:auto;margin-left: 2%;">
                <ul class="timeline">
                    {{range $k,$t := .XDWWorkflowDocument.TaskList.XDWTask}}
                    <li class="timeline-item">
                        <a href="{{$event.EventServices.EventService.EventUrl}}?act=widget&task=xdw&taskid={{$t.TaskData.TaskDetails.ID}}&pathway={{$event.Pathway}}&nhs={{$event.NHSId}}&vers={{$vers}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}"
                            target="workflowItem">
                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                            <div class="timeline-badge warning"><i class="fa fa-thumbs-down"></i></div>
                        {{else}}
                            {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                <div class="timeline-badge success"><i class="fa fa-thumbs-up"></i></div>
                            {{else}}
                                <div class="timeline-badge primary"><i class="fa fa-thumbs-up"></i></div>
                            {{end}}
                        {{end}}
                        </a>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                    <h6 class="timeline-title" style="color:darkgreen">Task {{$t.TaskData.TaskDetails.ID}} {{$t.TaskData.Description}}</h6>
                                {{else}}
                                    <h6 class="timeline-title" style="color:darkblue">Task {{$t.TaskData.TaskDetails.ID}} {{$t.TaskData.Description}}</h6>
                                {{end}}
                            </div>
                            <div class="timeline-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <label style="color:darkblue">Type</label>
                                        <p>{{$t.TaskData.TaskDetails.TaskType}}</p>
                                    </div>
                                    <div class="col-sm-5">
                                        <label style="color:darkblue">Owner</label>
                                        <p>{{$t.TaskData.TaskDetails.ActualOwner}}</p>                            
                                    </div>
                                    <div class="col-sm-2">
                                        <label style="color:darkblue">Status</label>
                                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                            <p style="color:darkgreen">{{$t.TaskData.TaskDetails.Status}}</p>
                                        {{else}}
                                            <p>{{$t.TaskData.TaskDetails.Status}}</p>
                                        {{end}}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Started</label>
                                        <p>{{$event.PrettyTime $t.TaskData.TaskDetails.ActivationTime}}</p>
                                    </div>
                                    <div class="col-sm-4">
                                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                            <label style="color:darkblue">Completed On</label>
                                        {{else}}
                                            <label style="color:darkblue">Updated</label>
                                        {{end}}
                                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                                            <p style="color:darkorange">{{$event.PrettyTime $t.TaskData.TaskDetails.LastModifiedTime}}</p>
                                        {{else}}
                                            <p>{{$event.PrettyTime $t.TaskData.TaskDetails.LastModifiedTime}}</p>
                                        {{end}}
                                    </div>
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Complete By</label>
                                        <p>{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-8">
                                        <label style="color:darkblue">Duration</label>
                                        <p>{{$event.TaskDuration $t.TaskData.TaskDetails.ID}}</p>
                                    </div>
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Overdue</label>
                                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                                        <p style="color:darkorange">Yes</p>
                                        {{else}}
                                        <p style="color:darkgreen">No</p>
                                        {{end}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    {{end}}
                </ul>
            </div>
        </div>
    </div>
</div>
{{end}} timelinewidget %!s(bool=false)]
2022/11/23 16:50:07.374455 tukutil.go:140: -----------------------------------------------------------------------------------
2022/11/23 16:50:07.375634 main.go:199: Loaded log file - ./logs/2022/1123.log
2022/11/23 16:50:07.375708 tukdbint.go:235: No Database API URL provided. Opening DB Connection to mysql instance via DSN - root:rootPass@tcp(localhost:3306)/tuk?parseTime=true&timeout=60s&readTimeout=2s
2022/11/23 16:50:07.378142 main.go:193: Loaded pixmpatient.html 
2022/11/23 16:50:07.378187 main.go:171: Persisting HTML Template pixmpatient.html
2022/11/23 16:50:07.378304 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [pixmpatient %!s(bool=false)]
2022/11/23 16:50:07.387037 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (template, name, isxml) VALUES (?, ?, ?) - Values [{{define "pixmpatient"}}
{{template "header" .}}
{{template "horizontalline"}}
{{$event := .}}
<div class="container-fluid">
    {{if ne (len .PIXmResponse.Entry) 0}} 
    {{range $entry:= .PIXmResponse.Entry}}
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="familyname">Family</label>
            <p id="familyname" name="familyname">{{range $entry.Resource.Name}}{{.Family}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="givenname">Given</label>
            <p id="givenname" name="givenname">{{range $entry.Resource.Name}}{{.Given}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="nameuse">Use</label>
            <p id="nameuse" name="nameuse">{{range $entry.Resource.Name}}{{.Use}} {{end}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="dob">Birth Date</label>
            <p id="dob" name="dob">{{$entry.Resource.BirthDate}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="gender">Gender</label>
            <p id="pc" name="pc">{{$entry.Resource.Gender}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="pc">PC</label>
            <p id="pc" name="pc">{{range $entry.Resource.Address}}{{.PostalCode}} {{end}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="addr">Address</label>
            <p id="addr" name="addr">{{range $entry.Resource.Address}}{{.Line}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="city">City</label>
            <p id="city" name="city">{{range $entry.Resource.Address}}{{.City}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="addruse">Use</label>
            <p id="addruse" name="addruse">{{range $entry.Resource.Address}}{{.Use}} {{end}}</p>
        </div>
    </div>
    {{end}}
    {{template "horizontalline"}}
    <div class="row" style="color:blue;">
        <div class="col-sm-3">
            <label for="pid">Patient ID</label>
        </div>
        <div class="col-sm-9">
            <label for="authuid">ID Type</label>
        </div>
    </div>
    {{range $entry:= .PIXmResponse.Entry}} 
    {{range $entry.Resource.Identifier}}
    <div class="row">
         <div class="col-sm-3">
            <p id="pid" name="pid">{{.Value}}</p>
        </div>
        <div class="col-sm-9">
            <p id="authuid" name="authuid">{{$event.GetMappedId ($event.GetMappedId (splitfhiroid .System))}}</p>
        </div>
    </div>
    {{end}}
    {{end}}
    {{else}}
    <h3>Unable to connect to Patient Service. Some Patient Demographics are not available</h3>
    {{end}}
</div>
</body>
{{template "footer"}}
{{end}} pixmpatient %!s(bool=false)]
2022/11/23 16:50:07.393462 main.go:193: Loaded subscriptions.html 
2022/11/23 16:50:07.393499 main.go:171: Persisting HTML Template subscriptions.html
2022/11/23 16:50:07.393531 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [subscriptions %!s(bool=false)]
2022/11/23 16:50:07.394348 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [subscriptions %!s(bool=false) {{define "subscriptions"}} 
{{ template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
{{$event:= .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <h4 style="color: blue; text-align:center">Event Service Broker Subscriptions</h3>
        </div>
    </div>
    {{template "horizontalline"}} 
    {{range $k,$v := .DBSubscriptions.Subscriptions}}
    {{ if ne $k 0 }}
    <div class="row">
        <div class="col-sm-2">
            <label for="expression">Created</label>
            <p id="expression" name="expression">{{$v.Created}}</p>
        </div>
        <div class="col-sm-2">
            <label for="expression">Pathway</label>
            <p id="expression" name="expression">{{$event.GetMappedId $v.Pathway}}</p>
        </div>
        <div class="col-sm-2">
            <label for="expression">Expression</label>
            <p id="expression" name="expression">{{$v.Expression}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-mb-2">
            <a href="{{$url}}?act=subscriber&task=cancel&id={{$v.Id}}&saml={{$event.SAML}}">
                <span><button class="btn btn-outline-primary btn-sm" type="button"></span>Cancel Subscription</button>
                </span>
            </a>
        </div>
        <div class="col-sm-10">
            <p id="expression" name="expression">{{$v.BrokerRef}}</p>
        </div>
    </div>
    {{template "horizontalline"}}
    {{end}}
    {{end}}
</div>
</body>
{{ template "footer"}} 
{{end}}]
2022/11/23 16:50:07.399417 main.go:193: Loaded workflowtasks.html 
2022/11/23 16:50:07.399450 main.go:171: Persisting HTML Template workflowtasks.html
2022/11/23 16:50:07.399489 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflowtasks %!s(bool=false)]
2022/11/23 16:50:07.402208 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflowtasks %!s(bool=false) {{define "workflowtasks"}}
    {{$event := .}}
    {{$nhsid := .NHSId}}
    {{$url := .EventServices.EventService.EventUrl}}
    {{$usr := .EventServices.EventService.User}}
    {{$org := .EventServices.EventService.Org}}
    {{$role := .EventServices.EventService.Role}}
    {{$pw:=.Pathway}}
    {{$exp:=.Expression}}
    {{$top:=.Topic}}
    {{template "header" .}} 
        <div id="tasksDIV">
            {{range $k,$t := .XDWWorkflowDocument.TaskList.XDWTask}}
            {{$overdue := $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                <div class="row">
                    <div class="col-sm-1">
                        <h5 style="color: darkblue;text-align: center;">Task {{.TaskData.TaskDetails.ID}}</h5>
                    </div>
                    <div class="col-sm-11">
                        <h5 style="color: darkblue;">{{.TaskData.Description}}</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-1">
                        {{template "snip_workflow_task_col_status" $t}}
                    </div>
                    <div class="col-sm-1">
                        <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                        {{if $overdue}}
                        <p style="color: red;" id="overdue" name="overdue">YES</p>
                        {{else}}
                        <p style="color: green;" id="overdue" name="overdue">NO</p>
                        {{end}}
                    </div>
                    <div class="col-sm-2">
                        <label style="text-align: center;color: darkblue" for="completeby">Complete By</label> 
                        {{if $overdue}}
                        <p style="color: red;" id="completeby" name="completeby">{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                        {{else}}
                        <p style="color: green;" id="completeby" name="completeby">{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                        {{end}}
                    </div>
                    <div class="col-sm-3">
                        <label style="text-align: center;color: darkblue">
                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                        Completed On
                        {{else}}
                        Last Update
                        {{end}}
                        </label>
                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                            <p style="color: green;">{{$t.TaskData.TaskDetails.LastModifiedTime}}</p>
                        {{else}}
                            <p>{{$t.TaskData.TaskDetails.LastModifiedTime}}</p>
                        {{end}}
                    </div>
                </div>
                {{template "horizontalline"}}
                {{if $t.TaskData.Input}} 
                    {{range $t.TaskData.Input}}
                        <div class="row">
                            {{if $event.IsBrokerExpression .Part.AttachmentInfo.Name}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="inputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} Actioned By {{.Part.AttachmentInfo.AttachedBy}} On {{.Part.AttachmentInfo.AttachedTime}}</p>
                                    {{else}}
                                        <a href="{{$url}}?act=events&task=create&pathway={{$event.Pathway}}&taskid={{$t.TaskData.TaskDetails.ID}}&vers={{$event.Vers}}&topic=addComment&expression={{.Part.AttachmentInfo.Name}}&notes=Demo simulation of DSUB Broker Notification&nhs={{$event.NHSId}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}" target="workflowItem" onclick="togglesidebar()"><label style="color: darkblue;" for="inputexpression"><i class="fa-solid fa-envelope-open"></i> Waiting for {{.Part.AttachmentInfo.Name}} to be Published</label></a>
                                    {{end}}
                                </div>
                            {{else}} 
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="inputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} is Actioned</p>
                                        <textarea disabled type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes">{{$event.TaskNotes $t.TaskData.TaskDetails.ID}}</textarea>
                                    {{else}} 
                                        <form action="{{$url}}" target="workflowItem">
                                            <input type="hidden" class="form-control" id="taskid" name="taskid" value={{$t.TaskData.TaskDetails.ID}}>
                                            <input type="hidden" class="form-control" id="vers" name="vers" value={{$event.Vers}}>
                                            <input type="hidden" class="form-control" id="saml" name="saml" value={{$event.SAML}}>
                                            <input type="hidden" class="form-control" id="act" name="act" value="events">
                                            <input type="hidden" class="form-control" id="task" name="task" value="create">
                                            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{$event.Pathway}}">
                                            <input type="hidden" class="form-control" id="nhs" name="nhs" value="{{$event.NHSId}}">
                                            <input type="hidden" class="form-control" id="user" name="user" value="{{$event.EventServices.EventService.User}}">
                                            <input type="hidden" class="form-control" id="org" name="org" value="{{$event.EventServices.EventService.Org}}">
                                            <input type="hidden" class="form-control" id="role" name="role" value="{{$event.EventServices.EventService.Role}}">
                                            <input type="hidden" class="form-control" id="topic" name="topic" value="addComment">
                                            <input type="hidden" class="form-control" id="expression" name="expression" value="{{.Part.AttachmentInfo.Name}}"> 
                                            <button type="submit" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-person-circle-check"></i> Create Event - {{.Part.AttachmentInfo.Name}} </button>
                                            <textarea type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes" placeholder={{$event.TaskNotes $t.TaskData.TaskDetails.ID}}></textarea> 
                                        </form>
                                        </br>
                                    {{end}}
                                </div>
                            {{end}}
                        </div>
                    {{end}}
                {{end}}
                </br>
                {{if $t.TaskData.Output}}
                    {{range $t.TaskData.Output}}
                        <div class="row">
                            {{if $event.IsBrokerExpression .Part.AttachmentInfo.Name}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="outputexpression" name="outputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} Actioned By {{.Part.AttachmentInfo.AttachedBy}} On {{.Part.AttachmentInfo.AttachedTime}}</p>
                                    {{else}}
                                        <a href="{{$url}}?act=events&task=create&pathway={{$event.Pathway}}&taskid={{$t.TaskData.TaskDetails.ID}}&vers={{$event.Vers}}&topic=addComment&expression={{.Part.AttachmentInfo.Name}}&notes=Demo simulation of DSUB Broker Notification&nhs={{$event.NHSId}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}" target="workflowItem" onclick="togglesidebar()"><label style="color: darkblue;" for="inputexpression"><i class="fa-solid fa-envelope-open"></i> Waiting for {{.Part.AttachmentInfo.Name}} to be Published</label></a>
                                    {{end}}
                                </div>
                            {{else}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="outputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} is Actioned</p>
                                        <textarea disabled type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes">{{$event.TaskNotes $t.TaskData.TaskDetails.ID}}</textarea>
                                    {{else}} 
                                        <form action="{{$url}}" target="workflowItem">
                                            <input type="hidden" class="form-control" id="taskid" name="taskid" value={{$t.TaskData.TaskDetails.ID}}>
                                            <input type="hidden" class="form-control" id="vers" name="vers" value={{$event.Vers}}>
                                            <input type="hidden" class="form-control" id="saml" name="saml" value={{$event.SAML}}>
                                            <input type="hidden" class="form-control" id="act" name="act" value="events">
                                            <input type="hidden" class="form-control" id="task" name="task" value="create">
                                            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{$event.Pathway}}">
                                            <input type="hidden" class="form-control" id="nhs" name="nhs" value="{{$event.NHSId}}">
                                            <input type="hidden" class="form-control" id="user" name="user" value="{{$event.EventServices.EventService.User}}">
                                            <input type="hidden" class="form-control" id="org" name="org" value="{{$event.EventServices.EventService.Org}}">
                                            <input type="hidden" class="form-control" id="role" name="role" value="{{$event.EventServices.EventService.Role}}">
                                            <input type="hidden" class="form-control" id="topic" name="topic" value="addComment">
                                            <input type="hidden" class="form-control" id="expression" name="expression" value="{{.Part.AttachmentInfo.Name}}">
                                            <button type="submit" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-person-circle-check"></i> Create Event - {{.Part.AttachmentInfo.Name}} </button>
                                            <textarea type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes" placeholder={{$event.TaskNotes $t.TaskData.TaskDetails.ID}}></textarea>
                                        </form>
                                        </br>
                                    {{end}}
                                </div>
                            {{end}}
                        </div>
                    {{end}}
                {{end}}
            {{template "horizontalline"}}
            {{end}}
        </div>
    </body>
    {{template "footer"}}
{{end}}]
2022/11/23 16:50:07.408307 main.go:193: Loaded dashboardwidget.html 
2022/11/23 16:50:07.408342 main.go:171: Persisting HTML Template dashboardwidget.html
2022/11/23 16:50:07.408375 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [dashboardwidget %!s(bool=false)]
2022/11/23 16:50:07.410627 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [dashboardwidget %!s(bool=false) {{define "dashboardwidget"}}
{{template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <img class="img-fluid left-block" src="/nhs-essex-trust-logo.jpeg" /></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <h1 style="color:darkblue;text-align: center;" class="center-block">{{.GetMappedId .Pathway}} Dashboard </h1>
        </div>
    </div>
    {{template "horizontalline"}}
    <div class="row text-center">
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-medkit fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Total}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text">Total</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-user-md fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.InProgress}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=open&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Open</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-thumbs-up fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Complete}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=closed&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Closed</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bullseye fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.TargetMet}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=met&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Target Met</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bell fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.TargetMissed}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=missed&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Target Missed</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bullhorn fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Escalated}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=escalated&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Require Escalation</p>
                </a>
            </div>
        </div>
    </div>
    <div id="dashboardItemDIV">
        <iframe scrolling="auto" margin="0" frameBorder="0" height="150px" width="100%" id="dashboardItem" name="dashboardItem" src="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}"></iframe>
    </div>
    <div id="workflowItemDIV">
        <iframe scrolling="auto" margin="0" frameBorder="0" height="500px" width="100%" id="workflowItem" name="workflowItem"></iframe>
    </div>
</body>
    <script>
        (function($) {
            $.fn.countTo = function(options) {
                options = options || {};

                return $(this).each(function() {
                    // set options for current element
                    var settings = $.extend({}, $.fn.countTo.defaults, {
                        from: $(this).data('from'),
                        to: $(this).data('to'),
                        speed: $(this).data('speed'),
                        refreshInterval: $(this).data('refresh-interval'),
                        decimals: $(this).data('decimals')
                    }, options);

                    // how many times to update the value, and how much to increment the value on each update
                    var loops = Math.ceil(settings.speed / settings.refreshInterval),
                        increment = (settings.to - settings.from) / loops;

                    // references & variables that will change with each update
                    var self = this,
                        $self = $(this),
                        loopCount = 0,
                        value = settings.from,
                        data = $self.data('countTo') || {};

                    $self.data('countTo', data);

                    // if an existing interval can be found, clear it first
                    if (data.interval) {
                        clearInterval(data.interval);
                    }
                    data.interval = setInterval(updateTimer, settings.refreshInterval);

                    // initialize the element with the starting value
                    render(value);

                    function updateTimer() {
                        value += increment;
                        loopCount++;

                        render(value);

                        if (typeof(settings.onUpdate) == 'function') {
                            settings.onUpdate.call(self, value);
                        }

                        if (loopCount >= loops) {
                            // remove the interval
                            $self.removeData('countTo');
                            clearInterval(data.interval);
                            value = settings.to;

                            if (typeof(settings.onComplete) == 'function') {
                                settings.onComplete.call(self, value);
                            }
                        }
                    }

                    function render(value) {
                        var formattedValue = settings.formatter.call(self, value, settings);
                        $self.html(formattedValue);
                    }
                });
            };

            $.fn.countTo.defaults = {
                from: 0, // the number the element should start at
                to: 0, // the number the element should end at
                speed: 1000, // how long it should take to count between the target numbers
                refreshInterval: 100, // how often the element should be updated
                decimals: 0, // the number of decimal places to show
                formatter: formatter, // handler for formatting the value before rendering
                onUpdate: null, // callback method for every time the element is updated
                onComplete: null // callback method for when the element finishes updating
            };

            function formatter(value, settings) {
                return value.toFixed(settings.decimals);
            }
        }(jQuery));

        jQuery(function($) {
            // custom formatting example
            $('.count-number').data('countToOptions', {
                formatter: function(value, options) {
                    return value.toFixed(options.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g, ',');
                }
            });

            // start all the timers
            $('.timer').each(count);

            function count(options) {
                var $this = $(this);
                options = $.extend({}, options || {}, $this.data('countToOptions') || {});
                $this.countTo(options);
            }
        });
    </script>
    <script>
        window.setInterval('refresh()', '{{.Op}}');

        function refresh() {
            window.location.reload();
        }
    </script>
{{template "footer" .}}
{{end}}]
2022/11/23 16:50:07.418668 main.go:193: Loaded snip_workflow_header.html 
2022/11/23 16:50:07.418699 main.go:171: Persisting HTML Template snip_workflow_header.html
2022/11/23 16:50:07.418732 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [snip_workflow_header %!s(bool=false)]
2022/11/23 16:50:07.419467 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [snip_workflow_header %!s(bool=false) {{define "snip_workflow_header"}}
<div class="container-fluid">
    <div class="center-block">
        <div class="row">
            <div class="col-sm-1">
                <label style="text-align: center;color: darkblue" for="conf">Conf Code</label>
                <p id="conf" name="conf">{{.WorkflowDefinition.Confidentialitycode}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="user">Opened By</label>
                <p id="user" name="user">{{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Prefix}} {{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Family}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="lupdt">Last Update</label>
                <p id="lupdt" name="lupdt">{{.PrettyTime .LastUpdateTime}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="comby">Complete By</label>
                <p id="comby" name="comby">{{.PrettyTime .CompletionTime}}</p>
            </div>
            <div class="col-sm-1">
                {{if .IsWorkflowOverdue}}
                <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                <p id="overdue" name="overdue" style="color: rgb(255, 170, 0)"><i class="fa fa-thumbs-down"></i> YES</p>
                {{else}}
                <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                <p id="overdue" name="overdue" style="color: green"><i class="fa fa-thumbs-up"></i> NO</p>
                {{end}}
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="elapsedtime">Elapsed Time</label>
                 {{if .IsWorkflowOverdue}}
                    <p style="color: darkorange;" id="elapsedtime" name="elapsedtime">{{.Elapsedtime}}</p>
                {{else}}
                    <p style="color: green;" id="elapsedtime" name="elaspedtime">{{.Elapsedtime}}</p>
                {{end}}
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="timeleft">Time Remaining</label>
                <p id="timeleft" name="timeleft">{{.WorkflowTimeRemaining}}</p>
            </div>
        </div>
    </div>
</div>

{{end}}]
2022/11/23 16:50:07.423479 main.go:193: Loaded workflows.html 
2022/11/23 16:50:07.423516 main.go:171: Persisting HTML Template workflows.html
2022/11/23 16:50:07.423567 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflows %!s(bool=false)]
2022/11/23 16:50:07.424728 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflows %!s(bool=false) {{define "workflows"}} 
{{ template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
{{$saml:= .SAML}}
{{$usr := .EventServices.EventService.User}}
{{$org := .EventServices.EventService.Org}}
{{$role := .EventServices.EventService.Role}}
{{$pw := .Pathway}}
{{$nhsid := .NHSId}}
{{$event := .}}
<div class="container-fluid">
    {{template "horizontalline"}}
    <div class="row">
        <div class="col-sm-12">
            <h3 style="text-align:center;color:darkblue">{{len .XDWDocuments}} {{.Status}} {{.GetMappedId $pw}}{{$nhsid}} Workflows</h3>
        </div>
    </div>
    {{range .XDWDocuments}}
    <div class="row">
        <div class="col-sm-1">
            <label style="color:darkblue" for="nhsid">NHS ID</label>
            <p id="nhsid" name="nhsid">{{.NHSId}}</p>
        </div>
       <div class="col-sm-2">
            <label style="color:darkblue" for="pwy">Pathway</label>
            <p id="pwy" name="pwy">{{$event.GetMappedId .Pathway}}</p>
        </div>
         <div class="col-sm-2">
            <label style="color:darkblue" for="created">Opened</label>
            <p id="created" name="created">{{$event.PrettyTime .Created}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:darkblue" for="xdwkey">XDW Key</label>
            <p id="xdwkey" name="xdwkey">{{.XDW_Key}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="status">Status</label>
            <p id="status" name="status">{{.Status}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="published">Published</label>
            <p id="published" name="published">{{.Published}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="version">Version</label>
            <a href="{{$url}}?act=widget&task=xdw&pathway={{.Pathway}}&nhs={{.NHSId}}&vers={{.Version}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="workflowItem"><p id="version" name="version">{{.Version}}</p></a>
        </div>
        {{if eq .Status "CLOSED"}}
        <div class="col-sm-2">
            <label style="color:darkblue" for="duration">Workflow Duration</label>
            <p id="version" name="version">{{$event.ElapsedTime .}}</p></a>
        </div>
        {{end}}
    </div>
    {{template "horizontalline"}}
    {{end}}
</div>    
</tbody>
{{ template "footer"}} 
{{end}}]
2022/11/23 16:50:07.431327 main.go:193: Loaded adminspawidget.html 
2022/11/23 16:50:07.431362 main.go:171: Persisting HTML Template adminspawidget.html
2022/11/23 16:50:07.431389 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE isxml= ? AND name= ? - Values [%!s(bool=false) adminspawidget]
2022/11/23 16:50:07.432140 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (isxml, template, name) VALUES (?, ?, ?) - Values [%!s(bool=false) {{define "adminspawidget"}}
{{$saml := .SAML}}
{{$url:= .EventServices.EventService.EventUrl}}
{{$nhsid:=.NHSId}}{{$usr:=.EventServices.EventService.User}}{{$org:=.EventServices.EventService.Org}}{{$role:=.EventServices.EventService.Role}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/style.css">

    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js" integrity="sha512-yFjZbTYRCJodnuyGlsKamNE/LlEaEAxSUDe5+u61mV8zzqJVFOH7TnULE2/PP/l5vKWpUNnF4VGVkXh3MjgLsg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar">
            <ul class="list-unstyled components">
                <li>
                    <a href="{{$url}}?act=widget&task=dashboard&op=600000&pathway={{.Pathway}}&nhs={{.NHSId}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="iadmin" onclick="togglesidebar()">Pathways Dashboard</a>
                </li>
                <hr></hr>
                <li>
                    <a href="{{$url}}?act=subscriber&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="iadmin" onclick="togglesidebar()">Manage Subscriptions</a>
                </li>
                <hr></hr>
                <li>
                    <a href="{{$url}}?act=admin&task=restart&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Restart Service</a>
                </li>
                <hr></hr>
                <li>
                    <a href="#updatesmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Update</a>
                    <ul class="collapse list-unstyled" id="updatesmenu">
                        <li>
                            <a href="{{$url}}?act=admin&task=initsrvcs&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Service Configs</a>
                        </li>
                        <li>
                            <a href="{{$url}}?act=admin&task=inittmplts&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Templates</a>
                        </li>
                        <li>
                            <a href="{{$url}}?act=admin&task=initxdws&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">XDW Configs</a>
                        </li>
                    </ul>
                </li>
                <hr></hr>
                <li>
                    <a href="#configsmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Configure</a>
                    <ul class="collapse list-unstyled" id="configsmenu">
                        <li>
                            <a href="#configsrvcsmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Services</a>
                            <ul class="collapse list-unstyled" id="configsrvcsmenu">
                                {{range .EventServices.ServiceConfigs}}
                                <li><a href="{{$url}}?act=services&task=get&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configxmlmsgmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Messages</a>
                            <ul class="collapse list-unstyled" id="configxmlmsgmenu">
                                {{range .EventServices.XMLMessages}}
                                <li><a href="{{$url}}?act=services&task=getxml&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configwidgetmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">HTML</a>
                            <ul class="collapse list-unstyled" id="configwidgetmenu">
                                {{range .EventServices.HTMLWidgets}}
                                <li><a href="{{$url}}?act=services&task=gethtml&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configxdwmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Pathways</a>
                            <ul class="collapse list-unstyled" id="configxdwmenu">
                                {{range .EventServices.WorkflowDefinitions}}
                                <li><a href="{{$url}}?act=services&task=getxdw&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#initsrvcs" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDS Meta</a>
                            <ul class="collapse list-unstyled" id="initsrvcs">
                                {{range .EventServices.WorkflowXDWMeta}}
                                <li><a href="{{$url}}?act=services&task=getmeta&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div id="content">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i> Admin                       
                    </button>
                </div>
            </nav>
        </div>
        <div class="col-sm-12">
            <iframe onload="window.top.scrollTo(0,0);" frameborder="0" onload="resizeIframe(this)" style="width:100%;height: 100%;" name="iadmin" id="iadmin"></iframe>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<script>
    $(document).ready(function() {
        $('#sidebarCollapse').on('click', function() {
            $('#sidebar').toggleClass('active');
        });
        $('#sidebar').toggleClass('active');
    });
</script>
<script>
    function togglesidebar() {
        $('#sidebar').toggleClass('active');
    }
</script>
<style>
    .wrapper {
        display: flex;
        align-items: stretch;
    }
    
    #sidebar {
        min-width: 250px;
        max-width: 250px;
        min-height: 100vh;
        background: #7386D5;
        color: #fff;
        transition: all 0.3s;
    }
    
    #sidebar.active {
        margin-left: -250px;
    }
    
    #sidebar .sidebar-header {
        padding: 20px;
        background: #6d7fcc;
    }
    
    #sidebar ul.components {
        padding: 20px 0;
        border-bottom: 1px solid #47748b;
    }
    
    #sidebar ul p {
        color: #fff;
        padding: 10px;
    }
    
    #sidebar ul li a {
        padding: 10px;
        font-size: 1.1em;
        display: block;
    }
    
    #sidebar ul li a:hover {
        color: #7386D5;
        background: #fff;
    }
    
    #sidebar ul li.active>a,
    a[aria-expanded="true"] {
        color: #fff;
        background: #6d7fcc;
    }
    
    ul ul a {
        font-size: 0.9em !important;
        padding-left: 30px !important;
        background: #6d7fcc;
    }
    
    a[data-toggle="collapse"] {
        position: relative;
    }
    
    .dropdown-toggle::after {
        display: block;
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
    }
    
    @media (max-width: 768px) {
        #sidebar {
            margin-left: -250px;
        }
        #sidebar.active {
            margin-left: 0;
        }
    }
</style>

</html>
{{end}} adminspawidget]
2022/11/23 16:50:07.438250 main.go:193: Loaded spawidget.html 
2022/11/23 16:50:07.438284 main.go:171: Persisting HTML Template spawidget.html
2022/11/23 16:50:07.438335 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [spawidget %!s(bool=false)]
2022/11/23 16:50:07.439097 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [spawidget %!s(bool=false) {{define "spawidget"}}
{{$url:= .EventServices.EventService.EventUrl}}
{{$pwy:= .Pathway}}
{{$nhsid:= .NHSId}}
{{$usr:= .EventServices.EventService.User}}
{{$org:= .EventServices.EventService.Org}}
{{$role:= .EventServices.EventService.Role}}
{{$event := .}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/style.css">

    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js" integrity="sha512-yFjZbTYRCJodnuyGlsKamNE/LlEaEAxSUDe5+u61mV8zzqJVFOH7TnULE2/PP/l5vKWpUNnF4VGVkXh3MjgLsg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar">
            <ul class="list-unstyled components">
                <li>
                    <a href="#pathwaymenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDW Consumer</a>
                    <ul class="collapse list-unstyled" id="pathwaymenu">
                        {{range .EventServices.ActivePathways}}
                            <li onclick="togglesidebar()"><a href="{{$url}}?act=widget&task=dashboard&vers=-1&op=600000&pathway={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">{{$event.GetMappedId .}}</a></li>
                        {{end}}
                    </ul>
                </li>
                 <li>
                    <a href="#newxdwmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDW Creator</a>
                    <ul class="collapse list-unstyled" id="newxdwmenu">
                        {{range .EventServices.WorkflowDefinitions}}
                            <li><a href="{{$url}}?act=XDW_Creator&task=getworkflow&pathway={{.}}&nhs={{$nhsid}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent" onclick="togglesidebar()">{{.}} Workflow</a></li>
                        {{end}}
                    </ul>
                </li>
                <li onclick="togglesidebar()"><a href="{{$url}}?act=widget&task=dashboard&vers=-1&op=600000&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">XDW Dashboard</a></li>
                <li onclick="togglesidebar()"><a href="{{$url}}?act=admin&vers=-1&op=600000&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">XDW Admin</a></li>
            </ul>
        </nav>
        <div id="content">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-outline-primary btn-sm"><i class="fas fa-align-left"></i></button>
                </div>
            </nav>
        </div>
         <div class="col-sm-12">
            <iframe onload="window.top.scrollTo(0,0);" width="100%" height="100%" frameborder="0" name="spacontent" title="spacontent" id="spacontent" src="{{$url}}?act=widget&task=dashboard&pathway={{.Pathway}}&vers=-1&op=600000&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{$event.SAML}}"></iframe>
        </div>
    </div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<script>
    $(document).ready(function() {
        $('#sidebarCollapse').on('click', function() {
            $('#sidebar').toggleClass('active');
        });
        togglesidebar()
    });
</script>
<script>
    function togglesidebar() {
        $('#sidebar').toggleClass('active');
    }
</script>
<style>
    .wrapper {
        display: flex;
        align-items: stretch;
    }
    
    #sidebar {
        min-width: 250px;
        max-width: 250px;
        min-height: 100vh;
        background: #d8dbe7;
        color: rgb(0, 0, 0);
        transition: all 0.3s;
    }
    
    #sidebar.active {
        margin-left: -250px;
    }
    
    #sidebar .sidebar-header {
        padding: 20px;
        background: #cfd6f3;
    }
    
    #sidebar ul.components {
        padding: 20px 0;
        border-bottom: 1px solid #96acb8;
    }
    
    #sidebar ul p {
        color: rgb(5, 5, 5);
        padding: 3px;
    }
    
    #sidebar ul li a {
        padding: 10px;
        font-size: 1.1em;
        display: block;
    }
    
    #sidebar ul li a:hover {
        color: #f6f7fa;
        background: rgb(72, 179, 250);
    }
    
    #sidebar ul li.active>a,
    a[aria-expanded="true"] {
        color: rgb(2, 2, 2);
        background: #6d7fcc;
    }
    
    ul ul a {
        font-size: 0.9em !important;
        padding-left: 30px !important;
        background: #b0b9e0;
    }
    
    a[data-toggle="collapse"] {
        position: relative;
    }
    
    .dropdown-toggle::after {
        display: block;
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
    }
    
    @media (max-width: 768px) {
        #sidebar {
            margin-left: -250px;
        }
        #sidebar.active {
            margin-left: 0;
        }
    }
</style>

</html>
{{end}}]
2022/11/23 16:50:07.443720 main.go:193: Loaded footer.html 
2022/11/23 16:50:07.443755 main.go:171: Persisting HTML Template footer.html
2022/11/23 16:50:07.443794 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [footer %!s(bool=false)]
2022/11/23 16:50:07.444493 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (isxml, template, name) VALUES (?, ?, ?) - Values [%!s(bool=false) {{define "footer"}}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>
<script>
    function openNav() {
        document.getElementById("mySidenav").style.width = "250px";
    }

    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
    }
</script>

</body>
<style>
    /* Timeline */
    
    .timeline,
    .timeline-horizontal {
        list-style: none;
        padding: 10px;
        position: relative;
    }
    
    .timeline:before {
        top: 20px;
        bottom: 0;
        position: absolute;
        content: " ";
        width: 3px;
        background-color: #eeeeee;
        left: 50%;
        margin-left: -1.5px;
    }
    
    .timeline .timeline-item {
        margin-bottom: 10px;
        position: relative;
    }
    
    .timeline .timeline-item:before,
    .timeline .timeline-item:after {
        content: "";
        display: table;
    }
    
    .timeline .timeline-item:after {
        clear: both;
    }
    
    .timeline .timeline-item .timeline-badge {
        color: #fff;
        width: 54px;
        height: 54px;
        line-height: 52px;
        font-size: 10px;
        text-align: center;
        position: absolute;
        top: 18px;
        left: 50%;
        margin-left: -25px;
        background-color: #7c7c7c;
        border: 3px solid #ffffff;
        z-index: 100;
        border-top-right-radius: 50%;
        border-top-left-radius: 50%;
        border-bottom-right-radius: 50%;
        border-bottom-left-radius: 50%;
    }
    
    .timeline .timeline-item .timeline-badge i,
    .timeline .timeline-item .timeline-badge .fa,
    .timeline .timeline-item .timeline-badge .glyphicon {
        top: 2px;
        left: 2px;
    }
    
    .timeline .timeline-item .timeline-badge.primary {
        background-color: #1f9eba;
    }
    
    .timeline .timeline-item .timeline-badge.info {
        background-color: #5bc0de;
    }
    
    .timeline .timeline-item .timeline-badge.success {
        background-color: #59ba1f;
    }
    
    .timeline .timeline-item .timeline-badge.warning {
        background-color: #d1bd10;
    }
    
    .timeline .timeline-item .timeline-badge.danger {
        background-color: #ba1f1f;
    }
    
    .timeline .timeline-item .timeline-panel {
        position: relative;
        width: 45%;
        float: left;
        right: 10px;
        border: 1px solid #c0c0c0;
        background: #ffffff;
        border-radius: 2px;
        padding: 10px;
        -webkit-box-shadow: 0 1px 6px rgba(0, 0, 0, 0.175);
        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.175);
    }
    
    .timeline .timeline-item .timeline-panel:before {
        position: absolute;
        top: 26px;
        right: -16px;
        display: inline-block;
        border-top: 16px solid transparent;
        border-left: 16px solid #c0c0c0;
        border-right: 0 solid #c0c0c0;
        border-bottom: 16px solid transparent;
        content: " ";
    }
    
    .timeline .timeline-item .timeline-panel .timeline-title {
        margin-top: 5px;
        color: inherit;
    }
    
    .timeline .timeline-item .timeline-panel .timeline-body>p,
    .timeline .timeline-item .timeline-panel .timeline-body>ul {
        margin-bottom: 0;
        margin-left: 10px;
    }
    
    .timeline .timeline-item .timeline-panel .timeline-body>p+p {
        margin-top: 5px;
    }
    
    .timeline .timeline-item:last-child:nth-child(even) {
        float: none;
    }
    
    .timeline .timeline-item:nth-child(even) .timeline-panel {
        float: right;
        left: 5px;
    }
    
    .timeline .timeline-item:nth-child(even) .timeline-panel:before {
        border-left-width: 0;
        border-right-width: 14px;
        left: -14px;
        right: auto;
    }
    
    .timeline-horizontal {
        list-style: none;
        position: relative;
        padding: 5px 0px 5px 0px;
        display: inline-block;
    }
    
    .timeline-horizontal:before {
        height: 3px;
        top: auto;
        bottom: 26px;
        left: 16px;
        right: 0;
        width: 100%;
        margin-bottom: 20px;
    }
    
    .timeline-horizontal .timeline-item {
        display: table-cell;
        height: 280px;
        width: 20%;
        min-width: 320px;
        float: none !important;
        padding-left: 0px;
        padding-right: 20px;
        margin: 0 auto;
        vertical-align: bottom;
    }
    
    .timeline-horizontal .timeline-item .timeline-panel {
        top: auto;
        bottom: 64px;
        display: inline-block;
        float: none !important;
        left: 0 !important;
        right: 0 !important;
        width: 100%;
        margin-bottom: 20px;
    }
    
    .timeline-horizontal .timeline-item .timeline-panel:before {
        top: auto;
        bottom: -16px;
        left: 28px !important;
        right: auto;
        border-right: 16px solid transparent !important;
        border-top: 16px solid #c0c0c0 !important;
        border-bottom: 0 solid #c0c0c0 !important;
        border-left: 16px solid transparent !important;
    }
    
    .timeline-horizontal .timeline-item:before,
    .timeline-horizontal .timeline-item:after {
        display: none;
    }
    
    .timeline-horizontal .timeline-item .timeline-badge {
        top: auto;
        bottom: 0px;
        left: 43px;
    }
    
    .counter {
        background-color: #f5f5f5;
        padding: 10px 0;
        border-radius: 5px;
    }
    
    .count-title {
        font-size: 30px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }
    
    .count-text {
        font-size: 20px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }
    
    .fa-2x {
        margin: 0 auto;
        float: none;
        display: table;
        color: #4ad1e5;
    }
    
    .loader-wrapper {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        background-color: #242f3f;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .loader {
        display: inline-block;
        width: 100px;
        height: 100px;
        position: relative;
        border: 4px solid #Fff;
        animation: loader 2s infinite ease;
    }
    
    .loader-inner {
        vertical-align: top;
        display: inline-block;
        width: 100%;
        background-color: #fff;
        animation: loader-inner 2s infinite ease-in;
    }
    
    @keyframes loader {
        0% {
            transform: rotate(0deg);
        }
        25% {
            transform: rotate(180deg);
        }
        50% {
            transform: rotate(180deg);
        }
        75% {
            transform: rotate(360deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
    
    @keyframes loader-inner {
        0% {
            height: 0%;
        }
        25% {
            height: 0%;
        }
        50% {
            height: 100%;
        }
        75% {
            height: 100%;
        }
        100% {
            height: 0%;
        }
    }
    
    .sidenav {
        display: none;
        height: 100%;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        background-color: #111;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 60px;
    }
    
    .sidenav a {
        padding: 8px 8px 8px 32px;
        text-decoration: none;
        font-size: 25px;
        color: #818181;
        display: block;
        transition: 0.3s;
    }
    
    .sidenav a:hover {
        color: #f1f1f1;
    }
    
    .sidenav .closebtn {
        position: absolute;
        top: 0;
        right: 15px;
        font-size: 36px;
        margin-left: 50px;
    }
    
    @media screen and (max-height: 450px) {
        .sidenav {
            padding-top: 15px;
        }
        .sidenav a {
            font-size: 18px;
        }
    }
    
    .item .item-content {
        padding: 30px 35px
    }
    
    .image-upload {
        width: 100%;
        height: 100px;
        border: 1px dashed #ddd;
        border-radius: 5px;
        margin-bottom: 20px;
        position: relative;
        text-align: center;
        background: #f8f8f9;
        color: #666;
        overflow: hidden
    }
    
    .item-wrapper form img {
        margin-bottom: 20px;
        width: auto;
        height: auto;
        max-height: 400px;
        width: auto;
        border-radius: 5px;
        overflow: hidden
    }
    
    .image-upload img {
        height: 100% !important;
        width: auto !important;
        border-radius: 0px;
        margin: 0 auto
    }
    
    .image-upload i {
        font-size: 6em;
        color: rgb(62, 25, 133)
    }
    
    .image-upload input {
        cursor: pointer;
        opacity: 0;
        height: 100%;
        width: 100%;
        z-index: 10;
        position: absolute;
        top: 0;
        left: 0
    }
    
    .item-wrapper input {
        height: 43px;
        line-height: 43px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 20px
    }
    
    .wrapper {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: stretch;
        justify-content: center;
    }
    
    .file-upload {
        height: 200px;
        width: 300px;
        border-radius: 100px;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        border: 4px solid #FFFFFF;
        overflow: hidden;
        background-image: linear-gradient(to bottom, #2590EB 50%, #FFFFFF 50%);
        background-size: 100% 200%;
        transition: all 1s;
        color: #0bd659;
        font-size: 75px;
    }
    
    .hidden {
        display: none;
    }
</style>

</html>{{end}} footer]
2022/11/23 16:50:07.448531 main.go:193: Loaded events.html 
2022/11/23 16:50:07.448560 main.go:171: Persisting HTML Template events.html
2022/11/23 16:50:07.448588 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [events %!s(bool=false)]
2022/11/23 16:50:07.449252 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [events %!s(bool=false) {{define "events"}} 
{{template "header" .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <h3 style="text-align:center;color:darkblue">{{.Pathway}} {{len .DBEvents}} Events</h3>
        </div>
    </div>
    {{range .DBEvents}}
        {{if ne .Id 0}}
        <div class="row">
                <div class="col-sm-2">
                <label style="color:darkblue" for="pathway">Pathway</label>
                <p id="pathway" name="pathway">{{.Pathway}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="expression">Event</label>
                <p id="expression" name="expression">{{.Expression}}</p>
            </div>
            <div class="col-sm-1">
                <label style="color:darkblue" for="topic">Task</label>
                <p id="topic" name="topic">{{.TaskId}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="authors">Created By</label>
                <p id="authors" name="authors">{{.Authors}}</p>
            </div>
            <div class="col-sm-1">
                <label style="color:darkblue" for="nhs">For Patient</label>
                <p id="nhs" name="nhs">{{.NhsId}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="created">Created</label>
                <p id="created" name="created">{{.Creationtime}}</p>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <label style="color:darkblue" for="notes">Notes</label>
                <textarea disabled id="notes" name="notes">{{.Comments}}</textarea>
            </div>
        </div>
        {{template "horizontalline"}}
        {{end}}
    {{end}}
</div>
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:50:07.452086 main.go:193: Loaded header.html 
2022/11/23 16:50:07.452116 main.go:171: Persisting HTML Template header.html
2022/11/23 16:50:07.452148 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE isxml= ? AND name= ? - Values [%!s(bool=false) header]
2022/11/23 16:50:07.452815 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [header %!s(bool=false) {{define "header"}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link rel="stylesheet" href="/eventservice.css">
    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/solid.min.css" integrity="sha512-LUxUs00S05YspUb2HCuUTBqTqbjJm2uNvwRXVTcl/jkr9ygYZptXhfknc52iBnPUNgHHHC9ivU4RV6UFxLxhfg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/js/all.min.js" integrity="sha512-Cvxz1E4gCrYKQfz6Ne+VoDiiLrbFBvc6BPh4iyKo2/ICdIodfgc5Q9cBjRivfQNUXBCEnQWcEInSXsvlNHY/ZQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <script defer src="https://use.fontawesome.com/releases/v6.0.1/js/solid.js " integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ " crossorigin="anonymous "></script>
    <script defer src="https://use.fontawesome.com/releases/v6.0.1/js/fontawesome.js " integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY " crossorigin="anonymous "></script> -->

    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js "></script>
</head>

<body>

    {{end}}]
2022/11/23 16:50:07.457993 main.go:193: Loaded pixpatient.html 
2022/11/23 16:50:07.458023 main.go:171: Persisting HTML Template pixpatient.html
2022/11/23 16:50:07.458053 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [pixpatient %!s(bool=false)]
2022/11/23 16:50:07.458714 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [pixpatient %!s(bool=false) {{define "pixpatient"}}
{{template "header" .}} 
{{$pat := .PDQv3Response.Body.PRPAIN201306UV02.ControlActProcess.Subject.RegistrationEvent.Subject1.Patient}}
{{template "horizontalline"}}
{{$event := .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <a href="#" onclick="togglePatient()"><i class="fa fa-bars">Toggle</i></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-1">
            <label style="color:blue;" for="givenname">Given</label>
            <p id="givenname" name="givenname">{{$pat.PatientPerson.Name.Given}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="familyname">Family</label>
            <p id="familyname" name="familyname">{{$pat.PatientPerson.Name.Family}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="dob">Birth Date</label>
            <p id="dob" name="dob">{{$pat.PatientPerson.BirthTime}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="gender">Gender</label>
            <p id="gender" name="gender">{{$pat.PatientPerson.AdministrativeGenderCode.Code}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="maritalStatusCode">Marital Status</label>
            <p id="maritalStatusCode" name="maritalStatusCode">{{$pat.PatientPerson.MaritalStatusCode.Code}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="twin">Twin</label>
            <p id="twin" name="twin">{{$pat.PatientPerson.MultipleBirthInd}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="telecom">Telcom</label>
            {{range $pat.PatientPerson.Telecom}}
            <p id="telecom" name="telecom">{{.Value}}</p>
            {{end}}
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="updated">Last Updated</label>
            <p id="updated" name="updated">{{$pat.EffectiveTime.Value}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="address">Address</label>
            <p id="address" name="address">{{$pat.PatientPerson.Addr.StreetAddressLine}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="city">City</label>
            <p id="city" name="city">{{$pat.PatientPerson.Addr.City}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="state">State</label>
            <p id="state" name="state">{{$pat.PatientPerson.Addr.State}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="zip">ZIP</label>
            <p id="zip" name="zip">{{$pat.PatientPerson.Addr.PostalCode}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="deceased">Deceased</label>
            <p id="deceased" name="deceased">{{$pat.PatientPerson.DeceasedInd}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="nat">Nat</label>
            <p id="nat" name="nat">{{$pat.PatientPerson.AsCitizen.PoliticalNation.Code.Code}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="birthplace">Birth Place</label>
            <p id="birthplace" name="birthplace">{{$pat.PatientPerson.BirthPlace.Addr.City}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="pid">Patient ID</label>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="idtype">ID Type</label>
        </div>
    </div>
    {{range $pat.ID}}
    <div class="row">
        <div class="col-sm-2">
            <p id="pid" name="pid">{{.Extension}}</p>
        </div>
        <div class="col-sm-2">
            <p id="idtype" name="idtype">{{$event.GetMappedId .AssigningAuthorityName}}</p>
        </div>
    </div>
    {{end}} 
</div>
{{template "footer"}} {{end}}]
2022/11/23 16:50:07.462895 main.go:193: Loaded horizontalline.html 
2022/11/23 16:50:07.462922 main.go:171: Persisting HTML Template horizontalline.html
2022/11/23 16:50:07.462950 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [horizontalline %!s(bool=false)]
2022/11/23 16:50:07.463549 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (template, name, isxml) VALUES (?, ?, ?) - Values [{{define "horizontalline"}}
<div class="row">
    <div class="col-sm-12">
        <hr></hr>
    </div>
</div>
{{end}} horizontalline %!s(bool=false)]
2022/11/23 16:50:07.466305 main.go:193: Loaded workflow.html 
2022/11/23 16:50:07.466334 main.go:171: Persisting HTML Template workflow.html
2022/11/23 16:50:07.466362 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflow %!s(bool=false)]
2022/11/23 16:50:07.467038 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflow %!s(bool=false) {{define "workflow"}}
{{template "header" .}}
{{template "snip_workflow_header" .}}
{{template "timelinewidget" .}}
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:50:07.470480 main.go:193: Loaded wfconfig.html 
2022/11/23 16:50:07.470508 main.go:171: Persisting HTML Template wfconfig.html
2022/11/23 16:50:07.470536 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [wfconfig %!s(bool=false)]
2022/11/23 16:50:07.471127 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [wfconfig %!s(bool=false) {{define "wfconfig"}}
{{template "header"}}
{{$url := .EventServices.EventService.EventUrl}}
<div class="container-fluid">
    <h3>{{if eq .Task "get"}}
         Service 
        {{end}} 
        {{if eq .Task "getxdw"}} 
         Pathway 
        {{end}} 
        {{if eq .Task "getmeta"}}
         XDS Meta 
        {{end}}
        {{if eq .Task "gethtml"}}
         HTML Widget 
        {{end}} 
        {{if eq .Task "getworkflow"}}
         Workflow  
        {{end}} 
        Configuration</h3>
    <form action="{{$url}}" target="iadmin">
        <div class="row">
            <input type="hidden" class="form-control" id="saml" name="saml" value={{.SAML}}>
            <input type="hidden" class="form-control" id="act" name="act" value="{{.Act}}">
            {{if eq .Task "get"}}
            <input type="hidden" class="form-control" id="task" name="task" value="set">
            {{end}}
            {{if eq .Task "getmeta"}}
            <input type="hidden" class="form-control" id="task" name="task" value="setmeta"> 
            {{end}}
            {{if eq .Task "getxdw"}}
            <input type="hidden" class="form-control" id="task" name="task" value="setxdw"> 
            {{end}}
            {{if eq .Task "gethtml"}}
            <input type="hidden" class="form-control" id="task" name="task" value="sethtml"> 
            {{end}}
            <input type="hidden" class="form-control" id="op" name="op" value="{{.Op}}">
            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{.Pathway}}">
            <input type="hidden" class="form-control" id="user" name="user" value="{{.EventServices.EventService.User}}">
            <input type="hidden" class="form-control" id="org" name="org" value="{{.EventServices.EventService.Org}}">
            <input type="hidden" class="form-control" id="role" name="role" value="{{.EventServices.EventService.Role}}">
        </div>
        <div class="row">
            <div class="col-sm-12 ">
                <hr></hr>
            </div>
        </div>
        {{if ne .Task "getworkflow"}}
            <textarea type="input" class="form-control" id="config" name="config" rows="25">{{.ConfigStr}}</textarea>
        {{else}}
            <textarea disabled type="input" class="form-control" id="config" name="config" rows="25">{{.ConfigStr}}</textarea>
        {{end}}
        <p> </p>
        {{if ne .Task "getworkflow"}}
            <button type="submit" class="btn btn-primary sm-2">Update</button>
        {{else}}
            <button disabled type="submit" class="btn btn-primary sm-2">Update</button>
        {{end}}
    </form>
</div>
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:50:07.473525 main.go:193: Loaded timelinewidget.html 
2022/11/23 16:50:07.473557 main.go:171: Persisting HTML Template timelinewidget.html
2022/11/23 16:50:07.473585 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [timelinewidget %!s(bool=false)]
2022/11/23 16:50:07.474186 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (isxml, template, name) VALUES (?, ?, ?) - Values [%!s(bool=false) {{define "timelinewidget"}}
{{$event := .}}
{{$vers := .Vers}}
<div class="center-block">
    <div class="row">
        <div class="col-sm-12">
            <h5 style="text-align:center;color:darkblue">{{.GetMappedId .Pathway}} Timeline for {{.NHSId}} Version {{.Vers}}</h5>
        </div>
    </div>
    {{template "horizontalline"}}
    <div class="row">
        <div class="col-sm-12">
            <div style="display:inline-block;width:100%;overflow-y:auto;margin-left: 2%;">
                <ul class="timeline">
                    {{range $k,$t := .XDWWorkflowDocument.TaskList.XDWTask}}
                    <li class="timeline-item">
                        <a href="{{$event.EventServices.EventService.EventUrl}}?act=widget&task=xdw&taskid={{$t.TaskData.TaskDetails.ID}}&pathway={{$event.Pathway}}&nhs={{$event.NHSId}}&vers={{$vers}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}"
                            target="workflowItem">
                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                            <div class="timeline-badge warning"><i class="fa fa-thumbs-down"></i></div>
                        {{else}}
                            {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                <div class="timeline-badge success"><i class="fa fa-thumbs-up"></i></div>
                            {{else}}
                                <div class="timeline-badge primary"><i class="fa fa-thumbs-up"></i></div>
                            {{end}}
                        {{end}}
                        </a>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                    <h6 class="timeline-title" style="color:darkgreen">Task {{$t.TaskData.TaskDetails.ID}} {{$t.TaskData.Description}}</h6>
                                {{else}}
                                    <h6 class="timeline-title" style="color:darkblue">Task {{$t.TaskData.TaskDetails.ID}} {{$t.TaskData.Description}}</h6>
                                {{end}}
                            </div>
                            <div class="timeline-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <label style="color:darkblue">Type</label>
                                        <p>{{$t.TaskData.TaskDetails.TaskType}}</p>
                                    </div>
                                    <div class="col-sm-5">
                                        <label style="color:darkblue">Owner</label>
                                        <p>{{$t.TaskData.TaskDetails.ActualOwner}}</p>                            
                                    </div>
                                    <div class="col-sm-2">
                                        <label style="color:darkblue">Status</label>
                                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                            <p style="color:darkgreen">{{$t.TaskData.TaskDetails.Status}}</p>
                                        {{else}}
                                            <p>{{$t.TaskData.TaskDetails.Status}}</p>
                                        {{end}}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Started</label>
                                        <p>{{$event.PrettyTime $t.TaskData.TaskDetails.ActivationTime}}</p>
                                    </div>
                                    <div class="col-sm-4">
                                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                            <label style="color:darkblue">Completed On</label>
                                        {{else}}
                                            <label style="color:darkblue">Updated</label>
                                        {{end}}
                                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                                            <p style="color:darkorange">{{$event.PrettyTime $t.TaskData.TaskDetails.LastModifiedTime}}</p>
                                        {{else}}
                                            <p>{{$event.PrettyTime $t.TaskData.TaskDetails.LastModifiedTime}}</p>
                                        {{end}}
                                    </div>
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Complete By</label>
                                        <p>{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-8">
                                        <label style="color:darkblue">Duration</label>
                                        <p>{{$event.TaskDuration $t.TaskData.TaskDetails.ID}}</p>
                                    </div>
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Overdue</label>
                                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                                        <p style="color:darkorange">Yes</p>
                                        {{else}}
                                        <p style="color:darkgreen">No</p>
                                        {{end}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    {{end}}
                </ul>
            </div>
        </div>
    </div>
</div>
{{end}} timelinewidget]
2022/11/23 16:52:50.438604 tukutil.go:140: -----------------------------------------------------------------------------------
2022/11/23 16:52:50.439956 main.go:199: Loaded log file - ./logs/2022/1123.log
2022/11/23 16:52:50.440044 tukdbint.go:235: No Database API URL provided. Opening DB Connection to mysql instance via DSN - root:rootPass@tcp(localhost:3306)/tuk?parseTime=true&timeout=60s&readTimeout=2s
2022/11/23 16:52:50.443981 main.go:193: Loaded pixmpatient.html 
2022/11/23 16:52:50.444027 main.go:171: Persisting HTML Template pixmpatient.html
2022/11/23 16:52:50.444148 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [pixmpatient %!s(bool=false)]
2022/11/23 16:52:50.467493 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [pixmpatient %!s(bool=false) {{define "pixmpatient"}}
{{template "header" .}}
{{template "horizontalline"}}
{{$event := .}}
<div class="container-fluid">
    {{if ne (len .PIXmResponse.Entry) 0}} 
    {{range $entry:= .PIXmResponse.Entry}}
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="familyname">Family</label>
            <p id="familyname" name="familyname">{{range $entry.Resource.Name}}{{.Family}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="givenname">Given</label>
            <p id="givenname" name="givenname">{{range $entry.Resource.Name}}{{.Given}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="nameuse">Use</label>
            <p id="nameuse" name="nameuse">{{range $entry.Resource.Name}}{{.Use}} {{end}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="dob">Birth Date</label>
            <p id="dob" name="dob">{{$entry.Resource.BirthDate}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="gender">Gender</label>
            <p id="pc" name="pc">{{$entry.Resource.Gender}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="pc">PC</label>
            <p id="pc" name="pc">{{range $entry.Resource.Address}}{{.PostalCode}} {{end}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="addr">Address</label>
            <p id="addr" name="addr">{{range $entry.Resource.Address}}{{.Line}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="city">City</label>
            <p id="city" name="city">{{range $entry.Resource.Address}}{{.City}} {{end}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="addruse">Use</label>
            <p id="addruse" name="addruse">{{range $entry.Resource.Address}}{{.Use}} {{end}}</p>
        </div>
    </div>
    {{end}}
    {{template "horizontalline"}}
    <div class="row" style="color:blue;">
        <div class="col-sm-3">
            <label for="pid">Patient ID</label>
        </div>
        <div class="col-sm-9">
            <label for="authuid">ID Type</label>
        </div>
    </div>
    {{range $entry:= .PIXmResponse.Entry}} 
    {{range $entry.Resource.Identifier}}
    <div class="row">
         <div class="col-sm-3">
            <p id="pid" name="pid">{{.Value}}</p>
        </div>
        <div class="col-sm-9">
            <p id="authuid" name="authuid">{{$event.GetMappedId ($event.GetMappedId (splitfhiroid .System))}}</p>
        </div>
    </div>
    {{end}}
    {{end}}
    {{else}}
    <h3>Unable to connect to Patient Service. Some Patient Demographics are not available</h3>
    {{end}}
</div>
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:52:50.474535 main.go:193: Loaded subscriptions.html 
2022/11/23 16:52:50.474580 main.go:171: Persisting HTML Template subscriptions.html
2022/11/23 16:52:50.474633 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [subscriptions %!s(bool=false)]
2022/11/23 16:52:50.477068 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [subscriptions %!s(bool=false) {{define "subscriptions"}} 
{{ template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
{{$event:= .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <h4 style="color: blue; text-align:center">Event Service Broker Subscriptions</h3>
        </div>
    </div>
    {{template "horizontalline"}} 
    {{range $k,$v := .DBSubscriptions.Subscriptions}}
    {{ if ne $k 0 }}
    <div class="row">
        <div class="col-sm-2">
            <label for="expression">Created</label>
            <p id="expression" name="expression">{{$v.Created}}</p>
        </div>
        <div class="col-sm-2">
            <label for="expression">Pathway</label>
            <p id="expression" name="expression">{{$event.GetMappedId $v.Pathway}}</p>
        </div>
        <div class="col-sm-2">
            <label for="expression">Expression</label>
            <p id="expression" name="expression">{{$v.Expression}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-mb-2">
            <a href="{{$url}}?act=subscriber&task=cancel&id={{$v.Id}}&saml={{$event.SAML}}">
                <span><button class="btn btn-outline-primary btn-sm" type="button"></span>Cancel Subscription</button>
                </span>
            </a>
        </div>
        <div class="col-sm-10">
            <p id="expression" name="expression">{{$v.BrokerRef}}</p>
        </div>
    </div>
    {{template "horizontalline"}}
    {{end}}
    {{end}}
</div>
</body>
{{ template "footer"}} 
{{end}}]
2022/11/23 16:52:50.481097 main.go:193: Loaded workflowtasks.html 
2022/11/23 16:52:50.481141 main.go:171: Persisting HTML Template workflowtasks.html
2022/11/23 16:52:50.481179 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflowtasks %!s(bool=false)]
2022/11/23 16:52:50.486547 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflowtasks %!s(bool=false) {{define "workflowtasks"}}
    {{$event := .}}
    {{$nhsid := .NHSId}}
    {{$url := .EventServices.EventService.EventUrl}}
    {{$usr := .EventServices.EventService.User}}
    {{$org := .EventServices.EventService.Org}}
    {{$role := .EventServices.EventService.Role}}
    {{$pw:=.Pathway}}
    {{$exp:=.Expression}}
    {{$top:=.Topic}}
    {{template "header" .}} 
        <div id="tasksDIV">
            {{range $k,$t := .XDWWorkflowDocument.TaskList.XDWTask}}
            {{$overdue := $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                <div class="row">
                    <div class="col-sm-1">
                        <h5 style="color: darkblue;text-align: center;">Task {{.TaskData.TaskDetails.ID}}</h5>
                    </div>
                    <div class="col-sm-11">
                        <h5 style="color: darkblue;">{{.TaskData.Description}}</h5>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-1">
                        {{template "snip_workflow_task_col_status" $t}}
                    </div>
                    <div class="col-sm-1">
                        <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                        {{if $overdue}}
                        <p style="color: red;" id="overdue" name="overdue">YES</p>
                        {{else}}
                        <p style="color: green;" id="overdue" name="overdue">NO</p>
                        {{end}}
                    </div>
                    <div class="col-sm-2">
                        <label style="text-align: center;color: darkblue" for="completeby">Complete By</label> 
                        {{if $overdue}}
                        <p style="color: red;" id="completeby" name="completeby">{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                        {{else}}
                        <p style="color: green;" id="completeby" name="completeby">{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                        {{end}}
                    </div>
                    <div class="col-sm-3">
                        <label style="text-align: center;color: darkblue">
                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                        Completed On
                        {{else}}
                        Last Update
                        {{end}}
                        </label>
                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                            <p style="color: green;">{{$t.TaskData.TaskDetails.LastModifiedTime}}</p>
                        {{else}}
                            <p>{{$t.TaskData.TaskDetails.LastModifiedTime}}</p>
                        {{end}}
                    </div>
                </div>
                {{template "horizontalline"}}
                {{if $t.TaskData.Input}} 
                    {{range $t.TaskData.Input}}
                        <div class="row">
                            {{if $event.IsBrokerExpression .Part.AttachmentInfo.Name}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="inputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} Actioned By {{.Part.AttachmentInfo.AttachedBy}} On {{.Part.AttachmentInfo.AttachedTime}}</p>
                                    {{else}}
                                        <a href="{{$url}}?act=events&task=create&pathway={{$event.Pathway}}&taskid={{$t.TaskData.TaskDetails.ID}}&vers={{$event.Vers}}&topic=addComment&expression={{.Part.AttachmentInfo.Name}}&notes=Demo simulation of DSUB Broker Notification&nhs={{$event.NHSId}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}" target="workflowItem" onclick="togglesidebar()"><label style="color: darkblue;" for="inputexpression"><i class="fa-solid fa-envelope-open"></i> Waiting for {{.Part.AttachmentInfo.Name}} to be Published</label></a>
                                    {{end}}
                                </div>
                            {{else}} 
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="inputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} is Actioned</p>
                                        <textarea disabled type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes">{{$event.TaskNotes $t.TaskData.TaskDetails.ID}}</textarea>
                                    {{else}} 
                                        <form action="{{$url}}" target="workflowItem">
                                            <input type="hidden" class="form-control" id="taskid" name="taskid" value={{$t.TaskData.TaskDetails.ID}}>
                                            <input type="hidden" class="form-control" id="vers" name="vers" value={{$event.Vers}}>
                                            <input type="hidden" class="form-control" id="saml" name="saml" value={{$event.SAML}}>
                                            <input type="hidden" class="form-control" id="act" name="act" value="events">
                                            <input type="hidden" class="form-control" id="task" name="task" value="create">
                                            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{$event.Pathway}}">
                                            <input type="hidden" class="form-control" id="nhs" name="nhs" value="{{$event.NHSId}}">
                                            <input type="hidden" class="form-control" id="user" name="user" value="{{$event.EventServices.EventService.User}}">
                                            <input type="hidden" class="form-control" id="org" name="org" value="{{$event.EventServices.EventService.Org}}">
                                            <input type="hidden" class="form-control" id="role" name="role" value="{{$event.EventServices.EventService.Role}}">
                                            <input type="hidden" class="form-control" id="topic" name="topic" value="addComment">
                                            <input type="hidden" class="form-control" id="expression" name="expression" value="{{.Part.AttachmentInfo.Name}}"> 
                                            <button type="submit" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-person-circle-check"></i> Create Event - {{.Part.AttachmentInfo.Name}} </button>
                                            <textarea type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes" placeholder={{$event.TaskNotes $t.TaskData.TaskDetails.ID}}></textarea> 
                                        </form>
                                        </br>
                                    {{end}}
                                </div>
                            {{end}}
                        </div>
                    {{end}}
                {{end}}
                </br>
                {{if $t.TaskData.Output}}
                    {{range $t.TaskData.Output}}
                        <div class="row">
                            {{if $event.IsBrokerExpression .Part.AttachmentInfo.Name}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="outputexpression" name="outputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} Actioned By {{.Part.AttachmentInfo.AttachedBy}} On {{.Part.AttachmentInfo.AttachedTime}}</p>
                                    {{else}}
                                        <a href="{{$url}}?act=events&task=create&pathway={{$event.Pathway}}&taskid={{$t.TaskData.TaskDetails.ID}}&vers={{$event.Vers}}&topic=addComment&expression={{.Part.AttachmentInfo.Name}}&notes=Demo simulation of DSUB Broker Notification&nhs={{$event.NHSId}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}" target="workflowItem" onclick="togglesidebar()"><label style="color: darkblue;" for="inputexpression"><i class="fa-solid fa-envelope-open"></i> Waiting for {{.Part.AttachmentInfo.Name}} to be Published</label></a>
                                    {{end}}
                                </div>
                            {{else}}
                                <div class="col-sm-8">
                                    {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                        <p id="inputexpression" name="outputexpression" style="color:darkgreen">{{.Part.AttachmentInfo.Name}} is Actioned</p>
                                        <textarea disabled type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes">{{$event.TaskNotes $t.TaskData.TaskDetails.ID}}</textarea>
                                    {{else}} 
                                        <form action="{{$url}}" target="workflowItem">
                                            <input type="hidden" class="form-control" id="taskid" name="taskid" value={{$t.TaskData.TaskDetails.ID}}>
                                            <input type="hidden" class="form-control" id="vers" name="vers" value={{$event.Vers}}>
                                            <input type="hidden" class="form-control" id="saml" name="saml" value={{$event.SAML}}>
                                            <input type="hidden" class="form-control" id="act" name="act" value="events">
                                            <input type="hidden" class="form-control" id="task" name="task" value="create">
                                            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{$event.Pathway}}">
                                            <input type="hidden" class="form-control" id="nhs" name="nhs" value="{{$event.NHSId}}">
                                            <input type="hidden" class="form-control" id="user" name="user" value="{{$event.EventServices.EventService.User}}">
                                            <input type="hidden" class="form-control" id="org" name="org" value="{{$event.EventServices.EventService.Org}}">
                                            <input type="hidden" class="form-control" id="role" name="role" value="{{$event.EventServices.EventService.Role}}">
                                            <input type="hidden" class="form-control" id="topic" name="topic" value="addComment">
                                            <input type="hidden" class="form-control" id="expression" name="expression" value="{{.Part.AttachmentInfo.Name}}">
                                            <button type="submit" class="btn btn-outline-primary btn-sm"><i class="fa-solid fa-person-circle-check"></i> Create Event - {{.Part.AttachmentInfo.Name}} </button>
                                            <textarea type="text" class="form-control" aria-label="Small" aria-describedby="inputGroup-sizing-sm" name="notes" placeholder={{$event.TaskNotes $t.TaskData.TaskDetails.ID}}></textarea>
                                        </form>
                                        </br>
                                    {{end}}
                                </div>
                            {{end}}
                        </div>
                    {{end}}
                {{end}}
            {{template "horizontalline"}}
            {{end}}
        </div>
    </body>
    {{template "footer"}}
{{end}}]
2022/11/23 16:52:50.491331 main.go:193: Loaded dashboardwidget.html 
2022/11/23 16:52:50.491397 main.go:171: Persisting HTML Template dashboardwidget.html
2022/11/23 16:52:50.491461 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [dashboardwidget %!s(bool=false)]
2022/11/23 16:52:50.495682 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [dashboardwidget %!s(bool=false) {{define "dashboardwidget"}}
{{template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <img class="img-fluid left-block" src="/nhs-essex-trust-logo.jpeg" /></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-12">
            <h1 style="color:darkblue;text-align: center;" class="center-block">{{.GetMappedId .Pathway}} Dashboard </h1>
        </div>
    </div>
    {{template "horizontalline"}}
    <div class="row text-center">
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-medkit fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Total}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text">Total</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-user-md fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.InProgress}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=open&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Open</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-thumbs-up fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Complete}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=closed&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Closed</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bullseye fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.TargetMet}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=met&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Target Met</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bell fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.TargetMissed}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=missed&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Target Missed</p>
                </a>
            </div>
        </div>
        <div class="col-sm-2">
            <div class="counter">
                <i class="fa fa-bullhorn fa-2x"></i>
                <h2 class="timer count-title count-number" data-to="{{.Dashboard.Escalated}}" data-speed="1500"></h2>
                <a href="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&status=escalated&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="dashboardItem">
                    <p class="count-text ">Require Escalation</p>
                </a>
            </div>
        </div>
    </div>
    <div id="dashboardItemDIV">
        <iframe scrolling="auto" margin="0" frameBorder="0" height="150px" width="100%" id="dashboardItem" name="dashboardItem" src="{{$url}}?act=widget&task=xdws&pathway={{.Pathway}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}"></iframe>
    </div>
    <div id="workflowItemDIV">
        <iframe scrolling="auto" margin="0" frameBorder="0" height="500px" width="100%" id="workflowItem" name="workflowItem"></iframe>
    </div>
</body>
    <script>
        (function($) {
            $.fn.countTo = function(options) {
                options = options || {};

                return $(this).each(function() {
                    // set options for current element
                    var settings = $.extend({}, $.fn.countTo.defaults, {
                        from: $(this).data('from'),
                        to: $(this).data('to'),
                        speed: $(this).data('speed'),
                        refreshInterval: $(this).data('refresh-interval'),
                        decimals: $(this).data('decimals')
                    }, options);

                    // how many times to update the value, and how much to increment the value on each update
                    var loops = Math.ceil(settings.speed / settings.refreshInterval),
                        increment = (settings.to - settings.from) / loops;

                    // references & variables that will change with each update
                    var self = this,
                        $self = $(this),
                        loopCount = 0,
                        value = settings.from,
                        data = $self.data('countTo') || {};

                    $self.data('countTo', data);

                    // if an existing interval can be found, clear it first
                    if (data.interval) {
                        clearInterval(data.interval);
                    }
                    data.interval = setInterval(updateTimer, settings.refreshInterval);

                    // initialize the element with the starting value
                    render(value);

                    function updateTimer() {
                        value += increment;
                        loopCount++;

                        render(value);

                        if (typeof(settings.onUpdate) == 'function') {
                            settings.onUpdate.call(self, value);
                        }

                        if (loopCount >= loops) {
                            // remove the interval
                            $self.removeData('countTo');
                            clearInterval(data.interval);
                            value = settings.to;

                            if (typeof(settings.onComplete) == 'function') {
                                settings.onComplete.call(self, value);
                            }
                        }
                    }

                    function render(value) {
                        var formattedValue = settings.formatter.call(self, value, settings);
                        $self.html(formattedValue);
                    }
                });
            };

            $.fn.countTo.defaults = {
                from: 0, // the number the element should start at
                to: 0, // the number the element should end at
                speed: 1000, // how long it should take to count between the target numbers
                refreshInterval: 100, // how often the element should be updated
                decimals: 0, // the number of decimal places to show
                formatter: formatter, // handler for formatting the value before rendering
                onUpdate: null, // callback method for every time the element is updated
                onComplete: null // callback method for when the element finishes updating
            };

            function formatter(value, settings) {
                return value.toFixed(settings.decimals);
            }
        }(jQuery));

        jQuery(function($) {
            // custom formatting example
            $('.count-number').data('countToOptions', {
                formatter: function(value, options) {
                    return value.toFixed(options.decimals).replace(/\B(?=(?:\d{3})+(?!\d))/g, ',');
                }
            });

            // start all the timers
            $('.timer').each(count);

            function count(options) {
                var $this = $(this);
                options = $.extend({}, options || {}, $this.data('countToOptions') || {});
                $this.countTo(options);
            }
        });
    </script>
    <script>
        window.setInterval('refresh()', '{{.Op}}');

        function refresh() {
            window.location.reload();
        }
    </script>
{{template "footer" .}}
{{end}}]
2022/11/23 16:52:50.502478 main.go:193: Loaded snip_workflow_header.html 
2022/11/23 16:52:50.502518 main.go:171: Persisting HTML Template snip_workflow_header.html
2022/11/23 16:52:50.502551 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [snip_workflow_header %!s(bool=false)]
2022/11/23 16:52:50.505103 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [snip_workflow_header %!s(bool=false) {{define "snip_workflow_header"}}
<div class="container-fluid">
    <div class="center-block">
        <div class="row">
            <div class="col-sm-1">
                <label style="text-align: center;color: darkblue" for="conf">Conf Code</label>
                <p id="conf" name="conf">{{.WorkflowDefinition.Confidentialitycode}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="user">Opened By</label>
                <p id="user" name="user">{{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Prefix}} {{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Family}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="lupdt">Last Update</label>
                <p id="lupdt" name="lupdt">{{.PrettyTime .LastUpdateTime}}</p>
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="comby">Complete By</label>
                <p id="comby" name="comby">{{.PrettyTime .CompletionTime}}</p>
            </div>
            <div class="col-sm-1">
                {{if .IsWorkflowOverdue}}
                <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                <p id="overdue" name="overdue" style="color: rgb(255, 170, 0)"><i class="fa fa-thumbs-down"></i> YES</p>
                {{else}}
                <label style="text-align: center;color: darkblue" for="overdue">Overdue</label>
                <p id="overdue" name="overdue" style="color: green"><i class="fa fa-thumbs-up"></i> NO</p>
                {{end}}
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="elapsedtime">Elapsed Time</label>
                 {{if .IsWorkflowOverdue}}
                    <p style="color: darkorange;" id="elapsedtime" name="elapsedtime">{{.Elapsedtime}}</p>
                {{else}}
                    <p style="color: green;" id="elapsedtime" name="elaspedtime">{{.Elapsedtime}}</p>
                {{end}}
            </div>
            <div class="col-sm-2">
                <label style="text-align: center;color: darkblue" for="timeleft">Time Remaining</label>
                <p id="timeleft" name="timeleft">{{.WorkflowTimeRemaining}}</p>
            </div>
        </div>
    </div>
</div>

{{end}}]
2022/11/23 16:52:50.508921 main.go:193: Loaded workflows.html 
2022/11/23 16:52:50.508962 main.go:171: Persisting HTML Template workflows.html
2022/11/23 16:52:50.509018 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflows %!s(bool=false)]
2022/11/23 16:52:50.510958 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflows %!s(bool=false) {{define "workflows"}} 
{{ template "header" .}}
{{$url := .EventServices.EventService.EventUrl}}
{{$saml:= .SAML}}
{{$usr := .EventServices.EventService.User}}
{{$org := .EventServices.EventService.Org}}
{{$role := .EventServices.EventService.Role}}
{{$pw := .Pathway}}
{{$nhsid := .NHSId}}
{{$event := .}}
<div class="container-fluid">
    {{template "horizontalline"}}
    <div class="row">
        <div class="col-sm-12">
            <h3 style="text-align:center;color:darkblue">{{len .XDWDocuments}} {{.Status}} {{.GetMappedId $pw}}{{$nhsid}} Workflows</h3>
        </div>
    </div>
    {{range .XDWDocuments}}
    <div class="row">
        <div class="col-sm-1">
            <label style="color:darkblue" for="nhsid">NHS ID</label>
            <p id="nhsid" name="nhsid">{{.NHSId}}</p>
        </div>
       <div class="col-sm-2">
            <label style="color:darkblue" for="pwy">Pathway</label>
            <p id="pwy" name="pwy">{{$event.GetMappedId .Pathway}}</p>
        </div>
         <div class="col-sm-2">
            <label style="color:darkblue" for="created">Opened</label>
            <p id="created" name="created">{{$event.PrettyTime .Created}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:darkblue" for="xdwkey">XDW Key</label>
            <p id="xdwkey" name="xdwkey">{{.XDW_Key}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="status">Status</label>
            <p id="status" name="status">{{.Status}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="published">Published</label>
            <p id="published" name="published">{{.Published}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:darkblue" for="version">Version</label>
            <a href="{{$url}}?act=widget&task=xdw&pathway={{.Pathway}}&nhs={{.NHSId}}&vers={{.Version}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="workflowItem"><p id="version" name="version">{{.Version}}</p></a>
        </div>
        {{if eq .Status "CLOSED"}}
        <div class="col-sm-2">
            <label style="color:darkblue" for="duration">Workflow Duration</label>
            <p id="version" name="version">{{$event.ElapsedTime .}}</p></a>
        </div>
        {{end}}
    </div>
    {{template "horizontalline"}}
    {{end}}
</div>    
</tbody>
{{ template "footer"}} 
{{end}}]
2022/11/23 16:52:50.514656 main.go:193: Loaded adminspawidget.html 
2022/11/23 16:52:50.514693 main.go:171: Persisting HTML Template adminspawidget.html
2022/11/23 16:52:50.514726 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [adminspawidget %!s(bool=false)]
2022/11/23 16:52:50.518906 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [adminspawidget %!s(bool=false) {{define "adminspawidget"}}
{{$saml := .SAML}}
{{$url:= .EventServices.EventService.EventUrl}}
{{$nhsid:=.NHSId}}{{$usr:=.EventServices.EventService.User}}{{$org:=.EventServices.EventService.Org}}{{$role:=.EventServices.EventService.Role}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/style.css">

    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js" integrity="sha512-yFjZbTYRCJodnuyGlsKamNE/LlEaEAxSUDe5+u61mV8zzqJVFOH7TnULE2/PP/l5vKWpUNnF4VGVkXh3MjgLsg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar">
            <ul class="list-unstyled components">
                <li>
                    <a href="{{$url}}?act=widget&task=dashboard&op=600000&pathway={{.Pathway}}&nhs={{.NHSId}}&vers=-1&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="iadmin" onclick="togglesidebar()">Pathways Dashboard</a>
                </li>
                <hr></hr>
                <li>
                    <a href="{{$url}}?act=subscriber&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" target="iadmin" onclick="togglesidebar()">Manage Subscriptions</a>
                </li>
                <hr></hr>
                <li>
                    <a href="{{$url}}?act=admin&task=restart&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Restart Service</a>
                </li>
                <hr></hr>
                <li>
                    <a href="#updatesmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Update</a>
                    <ul class="collapse list-unstyled" id="updatesmenu">
                        <li>
                            <a href="{{$url}}?act=admin&task=initsrvcs&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Service Configs</a>
                        </li>
                        <li>
                            <a href="{{$url}}?act=admin&task=inittmplts&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">Templates</a>
                        </li>
                        <li>
                            <a href="{{$url}}?act=admin&task=initxdws&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{.SAML}}" onclick="togglesidebar()">XDW Configs</a>
                        </li>
                    </ul>
                </li>
                <hr></hr>
                <li>
                    <a href="#configsmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Configure</a>
                    <ul class="collapse list-unstyled" id="configsmenu">
                        <li>
                            <a href="#configsrvcsmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Services</a>
                            <ul class="collapse list-unstyled" id="configsrvcsmenu">
                                {{range .EventServices.ServiceConfigs}}
                                <li><a href="{{$url}}?act=services&task=get&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configwidgetmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">HTML</a>
                            <ul class="collapse list-unstyled" id="configwidgetmenu">
                                {{range .EventServices.HTMLWidgets}}
                                <li><a href="{{$url}}?act=services&task=gethtml&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#configxdwmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Pathways</a>
                            <ul class="collapse list-unstyled" id="configxdwmenu">
                                {{range .EventServices.WorkflowDefinitions}}
                                <li><a href="{{$url}}?act=services&task=getxdw&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                        <li>
                            <a href="#initsrvcs" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDS Meta</a>
                            <ul class="collapse list-unstyled" id="initsrvcs">
                                {{range .EventServices.WorkflowXDWMeta}}
                                <li><a href="{{$url}}?act=services&task=getmeta&op={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}&saml={{$saml}}" target="iadmin" onclick="togglesidebar()">{{.}}</a></li>
                                {{end}}
                            </ul>
                        </li>
                    </ul>
                </li>
            </ul>
        </nav>
        <div id="content">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-info">
                        <i class="fas fa-align-left"></i> Admin                       
                    </button>
                </div>
            </nav>
        </div>
        <div class="col-sm-12">
            <iframe onload="window.top.scrollTo(0,0);" frameborder="0" onload="resizeIframe(this)" style="width:100%;height: 100%;" name="iadmin" id="iadmin"></iframe>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<script>
    $(document).ready(function() {
        $('#sidebarCollapse').on('click', function() {
            $('#sidebar').toggleClass('active');
        });
        $('#sidebar').toggleClass('active');
    });
</script>
<script>
    function togglesidebar() {
        $('#sidebar').toggleClass('active');
    }
</script>
<style>
    .wrapper {
        display: flex;
        align-items: stretch;
    }
    
    #sidebar {
        min-width: 250px;
        max-width: 250px;
        min-height: 100vh;
        background: #7386D5;
        color: #fff;
        transition: all 0.3s;
    }
    
    #sidebar.active {
        margin-left: -250px;
    }
    
    #sidebar .sidebar-header {
        padding: 20px;
        background: #6d7fcc;
    }
    
    #sidebar ul.components {
        padding: 20px 0;
        border-bottom: 1px solid #47748b;
    }
    
    #sidebar ul p {
        color: #fff;
        padding: 10px;
    }
    
    #sidebar ul li a {
        padding: 10px;
        font-size: 1.1em;
        display: block;
    }
    
    #sidebar ul li a:hover {
        color: #7386D5;
        background: #fff;
    }
    
    #sidebar ul li.active>a,
    a[aria-expanded="true"] {
        color: #fff;
        background: #6d7fcc;
    }
    
    ul ul a {
        font-size: 0.9em !important;
        padding-left: 30px !important;
        background: #6d7fcc;
    }
    
    a[data-toggle="collapse"] {
        position: relative;
    }
    
    .dropdown-toggle::after {
        display: block;
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
    }
    
    @media (max-width: 768px) {
        #sidebar {
            margin-left: -250px;
        }
        #sidebar.active {
            margin-left: 0;
        }
    }
</style>

</html>
{{end}}]
2022/11/23 16:52:50.523365 main.go:193: Loaded spawidget.html 
2022/11/23 16:52:50.523473 main.go:171: Persisting HTML Template spawidget.html
2022/11/23 16:52:50.523537 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [spawidget %!s(bool=false)]
2022/11/23 16:52:50.525719 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [spawidget %!s(bool=false) {{define "spawidget"}}
{{$url:= .EventServices.EventService.EventUrl}}
{{$pwy:= .Pathway}}
{{$nhsid:= .NHSId}}
{{$usr:= .EventServices.EventService.User}}
{{$org:= .EventServices.EventService.Org}}
{{$role:= .EventServices.EventService.Role}}
{{$event := .}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="/style.css">

    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js" integrity="sha512-yFjZbTYRCJodnuyGlsKamNE/LlEaEAxSUDe5+u61mV8zzqJVFOH7TnULE2/PP/l5vKWpUNnF4VGVkXh3MjgLsg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div class="wrapper">
        <nav id="sidebar">
            <ul class="list-unstyled components">
                <li>
                    <a href="#pathwaymenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDW Consumer</a>
                    <ul class="collapse list-unstyled" id="pathwaymenu">
                        {{range .EventServices.ActivePathways}}
                            <li onclick="togglesidebar()"><a href="{{$url}}?act=widget&task=dashboard&vers=-1&op=600000&pathway={{.}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">{{$event.GetMappedId .}}</a></li>
                        {{end}}
                    </ul>
                </li>
                 <li>
                    <a href="#newxdwmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">XDW Creator</a>
                    <ul class="collapse list-unstyled" id="newxdwmenu">
                        {{range .EventServices.WorkflowDefinitions}}
                            <li><a href="{{$url}}?act=XDW_Creator&task=getworkflow&pathway={{.}}&nhs={{$nhsid}}&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent" onclick="togglesidebar()">{{.}} Workflow</a></li>
                        {{end}}
                    </ul>
                </li>
                <li onclick="togglesidebar()"><a href="{{$url}}?act=widget&task=dashboard&vers=-1&op=600000&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">XDW Dashboard</a></li>
                <li onclick="togglesidebar()"><a href="{{$url}}?act=admin&vers=-1&op=600000&user={{$usr}}&org={{$org}}&role={{$role}}" target="spacontent">XDW Admin</a></li>
            </ul>
        </nav>
        <div id="content">
            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">
                    <button type="button" id="sidebarCollapse" class="btn btn-outline-primary btn-sm"><i class="fas fa-align-left"></i></button>
                </div>
            </nav>
        </div>
         <div class="col-sm-12">
            <iframe onload="window.top.scrollTo(0,0);" width="100%" height="100%" frameborder="0" name="spacontent" title="spacontent" id="spacontent" src="{{$url}}?act=widget&task=dashboard&pathway={{.Pathway}}&vers=-1&op=600000&user={{.EventServices.EventService.User}}&org={{.EventServices.EventService.Org}}&role={{.EventServices.EventService.Role}}&saml={{$event.SAML}}"></iframe>
        </div>
    </div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>

<script>
    $(document).ready(function() {
        $('#sidebarCollapse').on('click', function() {
            $('#sidebar').toggleClass('active');
        });
        togglesidebar()
    });
</script>
<script>
    function togglesidebar() {
        $('#sidebar').toggleClass('active');
    }
</script>
<style>
    .wrapper {
        display: flex;
        align-items: stretch;
    }
    
    #sidebar {
        min-width: 250px;
        max-width: 250px;
        min-height: 100vh;
        background: #d8dbe7;
        color: rgb(0, 0, 0);
        transition: all 0.3s;
    }
    
    #sidebar.active {
        margin-left: -250px;
    }
    
    #sidebar .sidebar-header {
        padding: 20px;
        background: #cfd6f3;
    }
    
    #sidebar ul.components {
        padding: 20px 0;
        border-bottom: 1px solid #96acb8;
    }
    
    #sidebar ul p {
        color: rgb(5, 5, 5);
        padding: 3px;
    }
    
    #sidebar ul li a {
        padding: 10px;
        font-size: 1.1em;
        display: block;
    }
    
    #sidebar ul li a:hover {
        color: #f6f7fa;
        background: rgb(72, 179, 250);
    }
    
    #sidebar ul li.active>a,
    a[aria-expanded="true"] {
        color: rgb(2, 2, 2);
        background: #6d7fcc;
    }
    
    ul ul a {
        font-size: 0.9em !important;
        padding-left: 30px !important;
        background: #b0b9e0;
    }
    
    a[data-toggle="collapse"] {
        position: relative;
    }
    
    .dropdown-toggle::after {
        display: block;
        position: absolute;
        top: 50%;
        right: 20px;
        transform: translateY(-50%);
    }
    
    @media (max-width: 768px) {
        #sidebar {
            margin-left: -250px;
        }
        #sidebar.active {
            margin-left: 0;
        }
    }
</style>

</html>
{{end}}]
2022/11/23 16:52:50.530110 main.go:193: Loaded footer.html 
2022/11/23 16:52:50.530142 main.go:171: Persisting HTML Template footer.html
2022/11/23 16:52:50.530178 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [footer %!s(bool=false)]
2022/11/23 16:52:50.534428 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [footer %!s(bool=false) {{define "footer"}}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script>
    function resizeIframe(obj) {
        obj.style.height = obj.contentWindow.document.documentElement.scrollHeight + 'px';
    }
</script>
<script>
    function openNav() {
        document.getElementById("mySidenav").style.width = "250px";
    }

    function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
    }
</script>

</body>
<style>
    /* Timeline */
    
    .timeline,
    .timeline-horizontal {
        list-style: none;
        padding: 10px;
        position: relative;
    }
    
    .timeline:before {
        top: 20px;
        bottom: 0;
        position: absolute;
        content: " ";
        width: 3px;
        background-color: #eeeeee;
        left: 50%;
        margin-left: -1.5px;
    }
    
    .timeline .timeline-item {
        margin-bottom: 10px;
        position: relative;
    }
    
    .timeline .timeline-item:before,
    .timeline .timeline-item:after {
        content: "";
        display: table;
    }
    
    .timeline .timeline-item:after {
        clear: both;
    }
    
    .timeline .timeline-item .timeline-badge {
        color: #fff;
        width: 54px;
        height: 54px;
        line-height: 52px;
        font-size: 10px;
        text-align: center;
        position: absolute;
        top: 18px;
        left: 50%;
        margin-left: -25px;
        background-color: #7c7c7c;
        border: 3px solid #ffffff;
        z-index: 100;
        border-top-right-radius: 50%;
        border-top-left-radius: 50%;
        border-bottom-right-radius: 50%;
        border-bottom-left-radius: 50%;
    }
    
    .timeline .timeline-item .timeline-badge i,
    .timeline .timeline-item .timeline-badge .fa,
    .timeline .timeline-item .timeline-badge .glyphicon {
        top: 2px;
        left: 2px;
    }
    
    .timeline .timeline-item .timeline-badge.primary {
        background-color: #1f9eba;
    }
    
    .timeline .timeline-item .timeline-badge.info {
        background-color: #5bc0de;
    }
    
    .timeline .timeline-item .timeline-badge.success {
        background-color: #59ba1f;
    }
    
    .timeline .timeline-item .timeline-badge.warning {
        background-color: #d1bd10;
    }
    
    .timeline .timeline-item .timeline-badge.danger {
        background-color: #ba1f1f;
    }
    
    .timeline .timeline-item .timeline-panel {
        position: relative;
        width: 45%;
        float: left;
        right: 10px;
        border: 1px solid #c0c0c0;
        background: #ffffff;
        border-radius: 2px;
        padding: 10px;
        -webkit-box-shadow: 0 1px 6px rgba(0, 0, 0, 0.175);
        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.175);
    }
    
    .timeline .timeline-item .timeline-panel:before {
        position: absolute;
        top: 26px;
        right: -16px;
        display: inline-block;
        border-top: 16px solid transparent;
        border-left: 16px solid #c0c0c0;
        border-right: 0 solid #c0c0c0;
        border-bottom: 16px solid transparent;
        content: " ";
    }
    
    .timeline .timeline-item .timeline-panel .timeline-title {
        margin-top: 5px;
        color: inherit;
    }
    
    .timeline .timeline-item .timeline-panel .timeline-body>p,
    .timeline .timeline-item .timeline-panel .timeline-body>ul {
        margin-bottom: 0;
        margin-left: 10px;
    }
    
    .timeline .timeline-item .timeline-panel .timeline-body>p+p {
        margin-top: 5px;
    }
    
    .timeline .timeline-item:last-child:nth-child(even) {
        float: none;
    }
    
    .timeline .timeline-item:nth-child(even) .timeline-panel {
        float: right;
        left: 5px;
    }
    
    .timeline .timeline-item:nth-child(even) .timeline-panel:before {
        border-left-width: 0;
        border-right-width: 14px;
        left: -14px;
        right: auto;
    }
    
    .timeline-horizontal {
        list-style: none;
        position: relative;
        padding: 5px 0px 5px 0px;
        display: inline-block;
    }
    
    .timeline-horizontal:before {
        height: 3px;
        top: auto;
        bottom: 26px;
        left: 16px;
        right: 0;
        width: 100%;
        margin-bottom: 20px;
    }
    
    .timeline-horizontal .timeline-item {
        display: table-cell;
        height: 280px;
        width: 20%;
        min-width: 320px;
        float: none !important;
        padding-left: 0px;
        padding-right: 20px;
        margin: 0 auto;
        vertical-align: bottom;
    }
    
    .timeline-horizontal .timeline-item .timeline-panel {
        top: auto;
        bottom: 64px;
        display: inline-block;
        float: none !important;
        left: 0 !important;
        right: 0 !important;
        width: 100%;
        margin-bottom: 20px;
    }
    
    .timeline-horizontal .timeline-item .timeline-panel:before {
        top: auto;
        bottom: -16px;
        left: 28px !important;
        right: auto;
        border-right: 16px solid transparent !important;
        border-top: 16px solid #c0c0c0 !important;
        border-bottom: 0 solid #c0c0c0 !important;
        border-left: 16px solid transparent !important;
    }
    
    .timeline-horizontal .timeline-item:before,
    .timeline-horizontal .timeline-item:after {
        display: none;
    }
    
    .timeline-horizontal .timeline-item .timeline-badge {
        top: auto;
        bottom: 0px;
        left: 43px;
    }
    
    .counter {
        background-color: #f5f5f5;
        padding: 10px 0;
        border-radius: 5px;
    }
    
    .count-title {
        font-size: 30px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }
    
    .count-text {
        font-size: 20px;
        font-weight: normal;
        margin-top: 10px;
        margin-bottom: 0;
        text-align: center;
    }
    
    .fa-2x {
        margin: 0 auto;
        float: none;
        display: table;
        color: #4ad1e5;
    }
    
    .loader-wrapper {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        background-color: #242f3f;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .loader {
        display: inline-block;
        width: 100px;
        height: 100px;
        position: relative;
        border: 4px solid #Fff;
        animation: loader 2s infinite ease;
    }
    
    .loader-inner {
        vertical-align: top;
        display: inline-block;
        width: 100%;
        background-color: #fff;
        animation: loader-inner 2s infinite ease-in;
    }
    
    @keyframes loader {
        0% {
            transform: rotate(0deg);
        }
        25% {
            transform: rotate(180deg);
        }
        50% {
            transform: rotate(180deg);
        }
        75% {
            transform: rotate(360deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
    
    @keyframes loader-inner {
        0% {
            height: 0%;
        }
        25% {
            height: 0%;
        }
        50% {
            height: 100%;
        }
        75% {
            height: 100%;
        }
        100% {
            height: 0%;
        }
    }
    
    .sidenav {
        display: none;
        height: 100%;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        background-color: #111;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 60px;
    }
    
    .sidenav a {
        padding: 8px 8px 8px 32px;
        text-decoration: none;
        font-size: 25px;
        color: #818181;
        display: block;
        transition: 0.3s;
    }
    
    .sidenav a:hover {
        color: #f1f1f1;
    }
    
    .sidenav .closebtn {
        position: absolute;
        top: 0;
        right: 15px;
        font-size: 36px;
        margin-left: 50px;
    }
    
    @media screen and (max-height: 450px) {
        .sidenav {
            padding-top: 15px;
        }
        .sidenav a {
            font-size: 18px;
        }
    }
    
    .item .item-content {
        padding: 30px 35px
    }
    
    .image-upload {
        width: 100%;
        height: 100px;
        border: 1px dashed #ddd;
        border-radius: 5px;
        margin-bottom: 20px;
        position: relative;
        text-align: center;
        background: #f8f8f9;
        color: #666;
        overflow: hidden
    }
    
    .item-wrapper form img {
        margin-bottom: 20px;
        width: auto;
        height: auto;
        max-height: 400px;
        width: auto;
        border-radius: 5px;
        overflow: hidden
    }
    
    .image-upload img {
        height: 100% !important;
        width: auto !important;
        border-radius: 0px;
        margin: 0 auto
    }
    
    .image-upload i {
        font-size: 6em;
        color: rgb(62, 25, 133)
    }
    
    .image-upload input {
        cursor: pointer;
        opacity: 0;
        height: 100%;
        width: 100%;
        z-index: 10;
        position: absolute;
        top: 0;
        left: 0
    }
    
    .item-wrapper input {
        height: 43px;
        line-height: 43px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 20px
    }
    
    .wrapper {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: stretch;
        justify-content: center;
    }
    
    .file-upload {
        height: 200px;
        width: 300px;
        border-radius: 100px;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        border: 4px solid #FFFFFF;
        overflow: hidden;
        background-image: linear-gradient(to bottom, #2590EB 50%, #FFFFFF 50%);
        background-size: 100% 200%;
        transition: all 1s;
        color: #0bd659;
        font-size: 75px;
    }
    
    .hidden {
        display: none;
    }
</style>

</html>{{end}}]
2022/11/23 16:52:50.538860 main.go:193: Loaded events.html 
2022/11/23 16:52:50.538886 main.go:171: Persisting HTML Template events.html
2022/11/23 16:52:50.538913 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [events %!s(bool=false)]
2022/11/23 16:52:50.543663 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [events %!s(bool=false) {{define "events"}} 
{{template "header" .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <h3 style="text-align:center;color:darkblue">{{.Pathway}} {{len .DBEvents}} Events</h3>
        </div>
    </div>
    {{range .DBEvents}}
        {{if ne .Id 0}}
        <div class="row">
                <div class="col-sm-2">
                <label style="color:darkblue" for="pathway">Pathway</label>
                <p id="pathway" name="pathway">{{.Pathway}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="expression">Event</label>
                <p id="expression" name="expression">{{.Expression}}</p>
            </div>
            <div class="col-sm-1">
                <label style="color:darkblue" for="topic">Task</label>
                <p id="topic" name="topic">{{.TaskId}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="authors">Created By</label>
                <p id="authors" name="authors">{{.Authors}}</p>
            </div>
            <div class="col-sm-1">
                <label style="color:darkblue" for="nhs">For Patient</label>
                <p id="nhs" name="nhs">{{.NhsId}}</p>
            </div>
            <div class="col-sm-2">
                <label style="color:darkblue" for="created">Created</label>
                <p id="created" name="created">{{.Creationtime}}</p>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <label style="color:darkblue" for="notes">Notes</label>
                <textarea disabled id="notes" name="notes">{{.Comments}}</textarea>
            </div>
        </div>
        {{template "horizontalline"}}
        {{end}}
    {{end}}
</div>
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:52:50.547243 main.go:193: Loaded header.html 
2022/11/23 16:52:50.547269 main.go:171: Persisting HTML Template header.html
2022/11/23 16:52:50.547298 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [header %!s(bool=false)]
2022/11/23 16:52:50.549656 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [header %!s(bool=false) {{define "header"}}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ICS Event Service</title>

    <link rel="stylesheet" href="/eventservice.css">
    <script src="https://cdn.ravenjs.com/3.17.0/raven.min.js" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/solid.min.css" integrity="sha512-LUxUs00S05YspUb2HCuUTBqTqbjJm2uNvwRXVTcl/jkr9ygYZptXhfknc52iBnPUNgHHHC9ivU4RV6UFxLxhfg==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/js/all.min.js" integrity="sha512-Cvxz1E4gCrYKQfz6Ne+VoDiiLrbFBvc6BPh4iyKo2/ICdIodfgc5Q9cBjRivfQNUXBCEnQWcEInSXsvlNHY/ZQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- <script defer src="https://use.fontawesome.com/releases/v6.0.1/js/solid.js " integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ " crossorigin="anonymous "></script>
    <script defer src="https://use.fontawesome.com/releases/v6.0.1/js/fontawesome.js " integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY " crossorigin="anonymous "></script> -->

    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js "></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js "></script>
</head>

<body>

    {{end}}]
2022/11/23 16:52:50.553785 main.go:193: Loaded pixpatient.html 
2022/11/23 16:52:50.553811 main.go:171: Persisting HTML Template pixpatient.html
2022/11/23 16:52:50.553841 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [pixpatient %!s(bool=false)]
2022/11/23 16:52:50.556082 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [pixpatient %!s(bool=false) {{define "pixpatient"}}
{{template "header" .}} 
{{$pat := .PDQv3Response.Body.PRPAIN201306UV02.ControlActProcess.Subject.RegistrationEvent.Subject1.Patient}}
{{template "horizontalline"}}
{{$event := .}}
<div class="container-fluid">
    <div class="row">
        <div class="col-sm-12">
            <a href="#" onclick="togglePatient()"><i class="fa fa-bars">Toggle</i></a>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-1">
            <label style="color:blue;" for="givenname">Given</label>
            <p id="givenname" name="givenname">{{$pat.PatientPerson.Name.Given}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="familyname">Family</label>
            <p id="familyname" name="familyname">{{$pat.PatientPerson.Name.Family}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="dob">Birth Date</label>
            <p id="dob" name="dob">{{$pat.PatientPerson.BirthTime}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="gender">Gender</label>
            <p id="gender" name="gender">{{$pat.PatientPerson.AdministrativeGenderCode.Code}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="maritalStatusCode">Marital Status</label>
            <p id="maritalStatusCode" name="maritalStatusCode">{{$pat.PatientPerson.MaritalStatusCode.Code}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="twin">Twin</label>
            <p id="twin" name="twin">{{$pat.PatientPerson.MultipleBirthInd}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="telecom">Telcom</label>
            {{range $pat.PatientPerson.Telecom}}
            <p id="telecom" name="telecom">{{.Value}}</p>
            {{end}}
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="updated">Last Updated</label>
            <p id="updated" name="updated">{{$pat.EffectiveTime.Value}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="address">Address</label>
            <p id="address" name="address">{{$pat.PatientPerson.Addr.StreetAddressLine}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="city">City</label>
            <p id="city" name="city">{{$pat.PatientPerson.Addr.City}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="state">State</label>
            <p id="state" name="state">{{$pat.PatientPerson.Addr.State}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="zip">ZIP</label>
            <p id="zip" name="zip">{{$pat.PatientPerson.Addr.PostalCode}}</p>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="deceased">Deceased</label>
            <p id="deceased" name="deceased">{{$pat.PatientPerson.DeceasedInd}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="nat">Nat</label>
            <p id="nat" name="nat">{{$pat.PatientPerson.AsCitizen.PoliticalNation.Code.Code}}</p>
        </div>
        <div class="col-sm-1">
            <label style="color:blue;" for="birthplace">Birth Place</label>
            <p id="birthplace" name="birthplace">{{$pat.PatientPerson.BirthPlace.Addr.City}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-2">
            <label style="color:blue;" for="pid">Patient ID</label>
        </div>
        <div class="col-sm-2">
            <label style="color:blue;" for="idtype">ID Type</label>
        </div>
    </div>
    {{range $pat.ID}}
    <div class="row">
        <div class="col-sm-2">
            <p id="pid" name="pid">{{.Extension}}</p>
        </div>
        <div class="col-sm-2">
            <p id="idtype" name="idtype">{{$event.GetMappedId .AssigningAuthorityName}}</p>
        </div>
    </div>
    {{end}} 
</div>
{{template "footer"}} {{end}}]
2022/11/23 16:52:50.562112 main.go:193: Loaded horizontalline.html 
2022/11/23 16:52:50.562146 main.go:171: Persisting HTML Template horizontalline.html
2022/11/23 16:52:50.562180 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [horizontalline %!s(bool=false)]
2022/11/23 16:52:50.564465 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [horizontalline %!s(bool=false) {{define "horizontalline"}}
<div class="row">
    <div class="col-sm-12">
        <hr></hr>
    </div>
</div>
{{end}}]
2022/11/23 16:52:50.568196 main.go:193: Loaded workflow.html 
2022/11/23 16:52:50.568230 main.go:171: Persisting HTML Template workflow.html
2022/11/23 16:52:50.568265 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [workflow %!s(bool=false)]
2022/11/23 16:52:50.570630 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [workflow %!s(bool=false) {{define "workflow"}}
{{template "header" .}}
{{template "snip_workflow_header" .}}
{{template "timelinewidget" .}}
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:52:50.574884 main.go:193: Loaded wfconfig.html 
2022/11/23 16:52:50.574913 main.go:171: Persisting HTML Template wfconfig.html
2022/11/23 16:52:50.574942 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [wfconfig %!s(bool=false)]
2022/11/23 16:52:50.578081 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [wfconfig %!s(bool=false) {{define "wfconfig"}}
{{template "header"}}
{{$url := .EventServices.EventService.EventUrl}}
<div class="container-fluid">
    <h3>{{if eq .Task "get"}}
         Service 
        {{end}} 
        {{if eq .Task "getxdw"}} 
         Pathway 
        {{end}} 
        {{if eq .Task "getmeta"}}
         XDS Meta 
        {{end}}
        {{if eq .Task "gethtml"}}
         HTML Widget 
        {{end}} 
        {{if eq .Task "getworkflow"}}
         Workflow  
        {{end}} 
        Configuration</h3>
    <form action="{{$url}}" target="iadmin">
        <div class="row">
            <input type="hidden" class="form-control" id="saml" name="saml" value={{.SAML}}>
            <input type="hidden" class="form-control" id="act" name="act" value="{{.Act}}">
            {{if eq .Task "get"}}
            <input type="hidden" class="form-control" id="task" name="task" value="set">
            {{end}}
            {{if eq .Task "getmeta"}}
            <input type="hidden" class="form-control" id="task" name="task" value="setmeta"> 
            {{end}}
            {{if eq .Task "getxdw"}}
            <input type="hidden" class="form-control" id="task" name="task" value="setxdw"> 
            {{end}}
            {{if eq .Task "gethtml"}}
            <input type="hidden" class="form-control" id="task" name="task" value="sethtml"> 
            {{end}}
            <input type="hidden" class="form-control" id="op" name="op" value="{{.Op}}">
            <input type="hidden" class="form-control" id="pathway" name="pathway" value="{{.Pathway}}">
            <input type="hidden" class="form-control" id="user" name="user" value="{{.EventServices.EventService.User}}">
            <input type="hidden" class="form-control" id="org" name="org" value="{{.EventServices.EventService.Org}}">
            <input type="hidden" class="form-control" id="role" name="role" value="{{.EventServices.EventService.Role}}">
        </div>
        <div class="row">
            <div class="col-sm-12 ">
                <hr></hr>
            </div>
        </div>
        {{if ne .Task "getworkflow"}}
            <textarea type="input" class="form-control" id="config" name="config" rows="25">{{.ConfigStr}}</textarea>
        {{else}}
            <textarea disabled type="input" class="form-control" id="config" name="config" rows="25">{{.ConfigStr}}</textarea>
        {{end}}
        <p> </p>
        {{if ne .Task "getworkflow"}}
            <button type="submit" class="btn btn-primary sm-2">Update</button>
        {{else}}
            <button disabled type="submit" class="btn btn-primary sm-2">Update</button>
        {{end}}
    </form>
</div>
</body>
{{template "footer"}}
{{end}}]
2022/11/23 16:52:50.580440 main.go:193: Loaded timelinewidget.html 
2022/11/23 16:52:50.580470 main.go:171: Persisting HTML Template timelinewidget.html
2022/11/23 16:52:50.580498 tukdbint.go:922: Created Prepared Statement DELETE FROM templates WHERE name= ? AND isxml= ? - Values [timelinewidget %!s(bool=false)]
2022/11/23 16:52:50.583116 tukdbint.go:922: Created Prepared Statement INSERT INTO templates (name, isxml, template) VALUES (?, ?, ?) - Values [timelinewidget %!s(bool=false) {{define "timelinewidget"}}
{{$event := .}}
{{$vers := .Vers}}
<div class="center-block">
    <div class="row">
        <div class="col-sm-12">
            <h5 style="text-align:center;color:darkblue">{{.GetMappedId .Pathway}} Timeline for {{.NHSId}} Version {{.Vers}}</h5>
        </div>
    </div>
    {{template "horizontalline"}}
    <div class="row">
        <div class="col-sm-12">
            <div style="display:inline-block;width:100%;overflow-y:auto;margin-left: 2%;">
                <ul class="timeline">
                    {{range $k,$t := .XDWWorkflowDocument.TaskList.XDWTask}}
                    <li class="timeline-item">
                        <a href="{{$event.EventServices.EventService.EventUrl}}?act=widget&task=xdw&taskid={{$t.TaskData.TaskDetails.ID}}&pathway={{$event.Pathway}}&nhs={{$event.NHSId}}&vers={{$vers}}&user={{$event.EventServices.EventService.User}}&org={{$event.EventServices.EventService.Org}}&role={{$event.EventServices.EventService.Role}}"
                            target="workflowItem">
                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                            <div class="timeline-badge warning"><i class="fa fa-thumbs-down"></i></div>
                        {{else}}
                            {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                <div class="timeline-badge success"><i class="fa fa-thumbs-up"></i></div>
                            {{else}}
                                <div class="timeline-badge primary"><i class="fa fa-thumbs-up"></i></div>
                            {{end}}
                        {{end}}
                        </a>
                        <div class="timeline-panel">
                            <div class="timeline-heading">
                                {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                    <h6 class="timeline-title" style="color:darkgreen">Task {{$t.TaskData.TaskDetails.ID}} {{$t.TaskData.Description}}</h6>
                                {{else}}
                                    <h6 class="timeline-title" style="color:darkblue">Task {{$t.TaskData.TaskDetails.ID}} {{$t.TaskData.Description}}</h6>
                                {{end}}
                            </div>
                            <div class="timeline-body">
                                <div class="row">
                                    <div class="col-sm-3">
                                        <label style="color:darkblue">Type</label>
                                        <p>{{$t.TaskData.TaskDetails.TaskType}}</p>
                                    </div>
                                    <div class="col-sm-5">
                                        <label style="color:darkblue">Owner</label>
                                        <p>{{$t.TaskData.TaskDetails.ActualOwner}}</p>                            
                                    </div>
                                    <div class="col-sm-2">
                                        <label style="color:darkblue">Status</label>
                                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                            <p style="color:darkgreen">{{$t.TaskData.TaskDetails.Status}}</p>
                                        {{else}}
                                            <p>{{$t.TaskData.TaskDetails.Status}}</p>
                                        {{end}}
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Started</label>
                                        <p>{{$event.PrettyTime $t.TaskData.TaskDetails.ActivationTime}}</p>
                                    </div>
                                    <div class="col-sm-4">
                                        {{if eq $t.TaskData.TaskDetails.Status "COMPLETE"}}
                                            <label style="color:darkblue">Completed On</label>
                                        {{else}}
                                            <label style="color:darkblue">Updated</label>
                                        {{end}}
                                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                                            <p style="color:darkorange">{{$event.PrettyTime $t.TaskData.TaskDetails.LastModifiedTime}}</p>
                                        {{else}}
                                            <p>{{$event.PrettyTime $t.TaskData.TaskDetails.LastModifiedTime}}</p>
                                        {{end}}
                                    </div>
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Complete By</label>
                                        <p>{{$event.TaskCompleteByTimeString $t.TaskData.TaskDetails.ID}}</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-8">
                                        <label style="color:darkblue">Duration</label>
                                        <p>{{$event.TaskDuration $t.TaskData.TaskDetails.ID}}</p>
                                    </div>
                                    <div class="col-sm-4">
                                        <label style="color:darkblue">Overdue</label>
                                        {{if $event.IsTaskOverdue $t.TaskData.TaskDetails.ID}}
                                        <p style="color:darkorange">Yes</p>
                                        {{else}}
                                        <p style="color:darkgreen">No</p>
                                        {{end}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                    {{end}}
                </ul>
            </div>
        </div>
    </div>
</div>
{{end}}]
