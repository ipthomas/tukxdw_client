{{define "submitDocument"}}
<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
   <soap:Header/>
   <soap:Body>
      <rem:submit xmlns:rem="http://remoting.ws.ehr.spirit.com/">
         <arg0>
            <stateID>{{.StateID}}</stateID>
            <patient>
               <allowRemoteSubmit>false</allowRemoteSubmit>
               <birthdate>{{.PatientDetails.BirthDate}}</birthdate>
               <deathIndicator>false</deathIndicator>
               <familyName>{{.PatientDetails.FamilyName}}</familyName>
               <givenName>{{.PatientDetails.GivenName}}</givenName>
               <multipleBirth>false</multipleBirth>
               <nameTypeCode>L</nameTypeCode>
               <patientFlags>
                  <entry>
                     <key xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">NHS</key>
                     <value xsi:type="xs:string" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">9999999468</value>
                  </entry>
               </patientFlags>
               <pid>
                  <domain>
                     <authNamespaceID>NHS</authNamespaceID>
                     <authUniversalID>2.16.840.1.113883.2.1.4.1</authUniversalID>
                     <authUniversalIDType>ISO</authUniversalIDType>
                  </domain>
                  <ehrPIDType>32</ehrPIDType>
                  <patientID>{{.NHSId}}</patientID>
                  <patientIDType>HC</patientIDType>
               </pid>
               <pid>
                  <domain>
                     <authNamespaceID>{{mappedid .PIDOid}}</authNamespaceID>
                     <authUniversalID>{{.PIDOid}}</authUniversalID>
                     <authUniversalIDType>ISO</authUniversalIDType>
                  </domain>
                  <ehrPIDType>6</ehrPIDType>
                  <patientID>{{.PID}}</patientID>
                  <patientIDType>PI</patientIDType>
               </pid>
               <pid>
                  <domain>
                     <authNamespaceID>{{mappedid .REGOid}}</authNamespaceID>
                     <authUniversalID>{{.REGOid}}</authUniversalID>
                     <authUniversalIDType>ISO</authUniversalIDType>
                  </domain>
                  <ehrPIDType>1048</ehrPIDType>
                  <patientID>{{.REGId}}</patientID>
                  <patientIDType>RRI</patientIDType>
               </pid>
               <sex>F</sex>
               <subsetPatIdBehavior>2</subsetPatIdBehavior>
            </patient>
            <useHL7v3Style>false</useHL7v3Style>
            <encrypted>false</encrypted>
            <signed>false</signed>
            <srcSubmission>
               <documents>
                  <author>
                     <institution>{{.EventServices.EventService.Org}}</institution>
                     <person>{{.EventServices.EventService.User}}</person>
                  </author>
                  <bytes>{{.Base64EncodedFile}}</bytes>
                  <classCode>
                     <nodeRepresentation>{{.XDSDocumentMeta.Classcode}}</nodeRepresentation>
                     <schema>{{.XDSDocumentMeta.Classcodescheme}}</schema>
                     <value>{{.XDSDocumentMeta.Classcodevalue}}</value>
                  </classCode>
                  <confidentialityCode>
                     <nodeRepresentation>{{.XDSDocumentMeta.Confcode}}</nodeRepresentation>
                     <schema>{{.XDSDocumentMeta.Confcodescheme}}</schema>
                     <value>{{.XDSDocumentMeta.Confcodevalue}}</value>
                  </confidentialityCode>
                  <description>{{.XDSDocumentMeta.Docdesc}}</description>
                  <formatCode>
                     <nodeRepresentation>{{.XDSDocumentMeta.Formatcode}}</nodeRepresentation>
                     <schema>{{.XDSDocumentMeta.Formatcodescheme}}</schema>
                     <value>{{.XDSDocumentMeta.Formatcodevalue}}</value>
                  </formatCode>
                  <healthcareFacilityCode>
                     <nodeRepresentation>{{.XDSDocumentMeta.Facilitycode}}</nodeRepresentation>
                     <schema>{{.XDSDocumentMeta.Facilitycodescheme}}</schema>
                     <value>{{.XDSDocumentMeta.Facilitycodevalue}}</value>
                  </healthcareFacilityCode>
                  <languageCode>{{.XDSDocumentMeta.Languagecode}}</languageCode>
                  <mimeType>{{.XDSDocumentMeta.Mimetype}}</mimeType>
                  <name>{{.XDSDocumentMeta.Docname}}</name>
                  <practiceSettingCode>
                     <nodeRepresentation>{{.XDSDocumentMeta.Practicesettingcode}}</nodeRepresentation>
                     <schema>{{.XDSDocumentMeta.Practicesettingscheme}}</schema>
                     <value>{{.XDSDocumentMeta.Practicesettingvalue}}</value>
                  </practiceSettingCode>
                  <typeCode>
                     <nodeRepresentation>{{.XDSDocumentMeta.Typecode}}</nodeRepresentation>
                     <schema>{{.XDSDocumentMeta.Typecodescheme}}</schema>
                     <value>{{.XDSDocumentMeta.Typecodevalue}}</value>
                  </typeCode>
               </documents>
               <submissionSet>
                  <author>
                     <institution>{{.EventServices.EventService.Org}}</institution>
                     <person>{{.EventServices.EventService.User}}</person>
                  </author>
                  <contentTypeCode>
                     <nodeRepresentation>{{.XDSDocumentMeta.Typecode}}</nodeRepresentation>
                     <schema>{{.XDSDocumentMeta.Typecodescheme}}</schema>
                     <value>{{.XDSDocumentMeta.Typecodevalue}}</value>
                  </contentTypeCode>
                  <!-- <intendedRecipient>
                     <INet>whatever</INet>
                     <organisation>whatever</organisation>
                     <person>A00005</person>
                  </intendedRecipient> -->
                  <description>{{.XDSDocumentMeta.Docdesc}}</description>
                  <name>{{.XDSDocumentMeta.Docname}}</name>
               </submissionSet>
            </srcSubmission>
         </arg0>
      </rem:submit>
   </soap:Body>
</soap:Envelope>
{{end}}