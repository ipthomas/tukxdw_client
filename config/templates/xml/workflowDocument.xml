{{define "workflowDocument"}}
<xdw:WorkflowDocument xmlns:hl7="urn:hl7-org:v3"
    xmlns:ws-ht="http://docs.oasis-open.org/ns/bpel4people/ws-humantask/types/200803"
    xmlns:xdw="urn:ihe:iti:xdw:2011"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:ihe:iti:xdw:2011 XDW-2014-12-23.xsd">
    <xdw:id root="{{.XDWWorkflowDocument.ID.Root}}"/>
    <xdw:effectiveTime value="{{.XDWWorkflowDocument.EffectiveTime.Value}}"/>
    <xdw:confidentialityCode code="{{.XDWWorkflowDocument.ConfidentialityCode.Code}}"/>
    <xdw:patient>
        <xdw:id root="{{.XDWWorkflowDocument.Patient.ID.Root}}" extension="{{.XDWWorkflowDocument.Patient.ID.Extension}}" assigningAuthorityName="{{.XDWWorkflowDocument.Patient.ID.AssigningAuthorityName}}"/>
    </xdw:patient>
    <xdw:author>
        <xdw:assignedAuthor>
            <hl7:id root="{{.XDWWorkflowDocument.Author.AssignedAuthor.ID.Root}}" extension="{{.XDWWorkflowDocument.Author.AssignedAuthor.ID.Extension}}"/>
            <hl7:assignedPerson>
                <hl7:name>
                    <hl7:family>{{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Family}}</hl7:family>
                    <hl7:prefix>{{.XDWWorkflowDocument.Author.AssignedAuthor.AssignedPerson.Name.Prefix}}</hl7:prefix>
                </hl7:name>
            </hl7:assignedPerson>
        </xdw:assignedAuthor>
    </xdw:author>
    <xdw:workflowInstanceId>{{.XDWWorkflowDocument.WorkflowInstanceId}}</xdw:workflowInstanceId>
    <xdw:workflowDocumentSequenceNumber>{{.XDWWorkflowDocument.WorkflowDocumentSequenceNumber}}</xdw:workflowDocumentSequenceNumber>
    <xdw:workflowStatus>{{.XDWWorkflowDocument.WorkflowStatus}}</xdw:workflowStatus>
    <xdw:workflowStatusHistory>
        {{- range .XDWWorkflowDocument.WorkflowStatusHistory.DocumentEvent}}
        <xdw:documentEvent>
            <xdw:eventTime>{{.EventTime}}</xdw:eventTime>
            <xdw:eventType>{{.EventType}}</xdw:eventType>
            <xdw:taskEventIdentifier>{{.TaskEventIdentifier}}</xdw:taskEventIdentifier>
            <xdw:author>{{.Author}}</xdw:author>
            <xdw:previousStatus>{{- .PreviousStatus}}</xdw:previousStatus>
            <xdw:actualStatus>{{.ActualStatus}}</xdw:actualStatus>
        </xdw:documentEvent>
        {{- end}}
    </xdw:workflowStatusHistory>
    <xdw:workflowDefinitionReference>urn:oid:{{.XDWWorkflowDocument.WorkflowDefinitionReference}}</xdw:workflowDefinitionReference>
    <xdw:TaskList>
        {{- range .XDWWorkflowDocument.TaskList.XDWTask}}
        <xdw:XDWTask>
            <xdw:taskData>
                <ws-ht:taskDetails>
                    <ws-ht:id>{{.TaskData.TaskDetails.ID}}</ws-ht:id>
                    <ws-ht:taskType>{{.TaskData.TaskDetails.TaskType}}</ws-ht:taskType>
                    <ws-ht:name>{{.TaskData.TaskDetails.Name}}</ws-ht:name>
                    <ws-ht:status>{{.TaskData.TaskDetails.Status}}</ws-ht:status>
                    <ws-ht:actualOwner>{{.TaskData.TaskDetails.ActualOwner}}</ws-ht:actualOwner>
                    <ws-ht:createdTime>{{.TaskData.TaskDetails.CreatedTime}}</ws-ht:createdTime>
                    <ws-ht:createdBy>{{.TaskData.TaskDetails.CreatedBy}}</ws-ht:createdBy>
                    <ws-ht:lastModifiedTime>{{.TaskData.TaskDetails.LastModifiedTime}}</ws-ht:lastModifiedTime>
                    <ws-ht:renderingMethodExists>false</ws-ht:renderingMethodExists>
                </ws-ht:taskDetails>
                <ws-ht:description>{{.TaskData.Description}}</ws-ht:description>
                <ws-ht:input>
                    {{- range .TaskData.Input}}
                    <ws-ht:part name="{{.Part.Name}}">
                        <ws-ht:attachmentInfo>
                            <ws-ht:identifier>{{.Part.AttachmentInfo.Identifier}}</ws-ht:identifier>
                            <ws-ht:name>{{.Part.AttachmentInfo.Name}}</ws-ht:name>
                            <ws-ht:accessType>{{.Part.AttachmentInfo.AccessType}}</ws-ht:accessType>
                            <ws-ht:contentType>{{.Part.AttachmentInfo.ContentType}}</ws-ht:contentType>
                            <ws-ht:contentCategory>{{.Part.AttachmentInfo.ContentCategory}}</ws-ht:contentCategory>
                            <ws-ht:attachedTime>{{.Part.AttachmentInfo.AttachedTime}}</ws-ht:attachedTime>
                            <ws-ht:attachedBy>{{.Part.AttachmentInfo.AttachedBy}}</ws-ht:attachedBy>
                            <xdw:homeCommunityId>{{.Part.AttachmentInfo.HomeCommunityId}}</xdw:homeCommunityId>
                        </ws-ht:attachmentInfo>
                    </ws-ht:part>
                    {{- end}}
                </ws-ht:input>
                <ws-ht:output>
                    {{- range .TaskData.Output}}
                    <ws-ht:part name="{{.Part.Name}}">
                        <ws-ht:attachmentInfo>
                            <ws-ht:identifier>{{.Part.AttachmentInfo.Identifier}}</ws-ht:identifier>
                            <ws-ht:name>{{.Part.AttachmentInfo.Name}}</ws-ht:name>
                            <ws-ht:accessType>{{.Part.AttachmentInfo.AccessType}}</ws-ht:accessType>
                            <ws-ht:contentType>{{.Part.AttachmentInfo.ContentType}}</ws-ht:contentType>
                            <ws-ht:contentCategory>{{.Part.AttachmentInfo.ContentCategory}}</ws-ht:contentCategory>
                            <ws-ht:attachedTime>{{.Part.AttachmentInfo.AttachedTime}}</ws-ht:attachedTime>
                            <ws-ht:attachedBy>{{.Part.AttachmentInfo.AttachedBy}}</ws-ht:attachedBy>
                            <xdw:homeCommunityId>{{.Part.AttachmentInfo.HomeCommunityId}}</xdw:homeCommunityId>
                        </ws-ht:attachmentInfo>
                    </ws-ht:part>
                    {{- end}}
                </ws-ht:output>
            </xdw:taskData>
            <xdw:taskEventHistory>
                {{- range .TaskEventHistory.TaskEvent}}
                <xdw:taskEvent>
                    <xdw:id>{{.ID}}</xdw:id>
                    <xdw:eventTime>{{.EventTime}}</xdw:eventTime>
                    <xdw:identifier>{{.Identifier}}</xdw:identifier>
                    <xdw:eventType>{{.EventType}}</xdw:eventType>
                    <xdw:status>{{.Status}}</xdw:status>
                </xdw:taskEvent>
                {{- end}}
            </xdw:taskEventHistory>           
        </xdw:XDWTask>
        {{end}}
    </xdw:TaskList>
</xdw:WorkflowDocument>
{{end}}